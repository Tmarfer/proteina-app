<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prote√≠na Eficiente</title>
    <style>
        :root {
            --color-primary: #25d366;
            --color-text: #111;
            --color-bg: #fff;
            --color-surface: #f0f0f0;
            --color-border: #e5e5ea;
            --color-good: #34c759;
            --color-warning: #ff9500;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            padding: 16px;
            line-height: 1.5;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--color-primary);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 4px;
            color: var(--color-primary);
        }

        .header p {
            font-size: 12px;
            color: #666;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .sort-btn, .filter-btn {
            padding: 8px 12px;
            border: 1px solid var(--color-border);
            background: var(--color-surface);
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 200ms;
        }

        .sort-btn:active, .filter-btn:active, .sort-btn.active, .filter-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .sort-btn:hover, .filter-btn:hover {
            background: #f5f5f5;
        }

        .search-box {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-border);
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        thead {
            background: var(--color-surface);
            font-weight: 600;
        }

        th {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
            cursor: pointer;
            user-select: none;
            white-space: nowrap;
        }

        th:hover {
            background: #e8e8e8;
        }

        th .arrow {
            font-size: 10px;
            margin-left: 4px;
            opacity: 0.5;
        }

        th .arrow.active {
            opacity: 1;
        }

        td {
            padding: 12px 8px;
            border-bottom: 1px solid var(--color-border);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        tbody tr:hover {
            background: #f9f9f9;
        }

        .fonte-name {
            font-weight: 500;
            color: var(--color-text);
            min-width: 140px;
        }

        .proteina {
            color: var(--color-good);
            font-weight: 600;
        }
        
        .porcao {
            color: #666;
            font-size: 12px;
        }

        .custo-prot {
            color: var(--color-primary);
            font-weight: 600;
        }

        .best {
            background: rgba(52, 199, 89, 0.1);
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: var(--color-surface);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-primary);
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            padding: 12px;
            background: var(--color-surface);
            border-radius: 6px;
            font-size: 11px;
            color: #666;
        }

        .share-btn {
            width: 100%;
            padding: 12px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 16px;
            font-size: 14px;
            transition: background 200ms;
        }

        .share-btn:active {
            opacity: 0.9;
        }

        @media (max-width: 480px) {
            body {
                padding: 12px;
            }

            .header h1 {
                font-size: 20px;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 8px 6px;
            }

            .fonte-name {
                min-width: 100px;
            }

            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü•á Prote√≠na Eficiente</h1>
        <p>Melhor custo-benef√≠cio de prote√≠na</p>
    </div>

    <button class="share-btn" onclick="compartilharWhatsApp()">üì≤ Compartilhar no WhatsApp</button>

    <div style="margin: 16px 0; padding: 12px; background: var(--color-surface); border-radius: 6px;">
        <label for="pesoUsuario" style="display: block; margin-bottom: 8px; font-weight: 600;">Seu Peso (kg):</label>
        <input type="number" id="pesoUsuario" placeholder="Ex: 70" min="30" max="200" style="width: 100%; padding: 8px; border: 1px solid var(--color-border); border-radius: 4px; font-size: 14px;" onchange="calcularProteinaDiaria()">
        <p style="font-size: 12px; color: #666; margin: 8px 0 0 0;"><strong>Proteina necessaria:</strong> <span id="proteinaDiaria">-</span>g/dia</p>
        <p style="font-size: 11px; color: #999; margin: 4px 0 0 0;">
            Baseado em padr√£o de <a href="https://link.springer.com/article/10.1186/s12970-018-0215-1" target="_blank" style="color: var(--color-primary); text-decoration: none;">1.6-2.2g/kg (Refer√™ncia)</a> para treino de for√ßa<br>
            <strong>*Refer√™ncia: Journal of the International Society of Sports Nutrition</strong>
        </p>
    </div>

    <div class="stats">
        <div class="stat-card">
            <div class="stat-label">Mais Barato<br/><small>(R$/g Prot.)</small></div>
            <div class="stat-value" id="cheapest">R$ ‚Äî</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Mais Prote√≠na<br/><small>(g/por√ß√£o)</small></div>
            <div class="stat-value" id="best-protein">‚Äî g</div>
        </div>
    </div>

    <input type="text" class="search-box" id="searchInput" placeholder="üîç Buscar prote√≠na..." onkeyup="filtrarTabela()">

    <div class="controls">
        <button class="sort-btn" onclick="ordenar('fonte')">Fonte A‚ÜíZ</button>
        <button class="sort-btn active" onclick="ordenar('custoProteina')">Melhor Custo ‚¨áÔ∏è</button>
        <button class="sort-btn" onclick="ordenar('proteina')">Prote√≠na ‚¨áÔ∏è</button>
        <button class="filter-btn" onclick="filtrarCategoria('carne')">üçñ Carne</button>
        <button class="filter-btn" onclick="filtrarCategoria('frango')">üçó Frango</button>
        <button class="filter-btn" onclick="filtrarCategoria('peixe')">üêü Peixe</button>
        <button class="filter-btn" onclick="filtrarCategoria('suplemento')">‚ö° Suplem.</button>
        <button class="filter-btn" onclick="filtrarCategoria('outros')">ü•ö Outros</button>
        <button class="filter-btn" onclick="filtrarCategoria('')">Ver Tudo</button>
    </div>

    <div class="table-container">
        <table id="tabelaProteina">
            <thead>
                <tr>
                    <th onclick="ordenar('fonte')">Fonte <span class="arrow"></span></th>
                    <th onclick="ordenar('proteina')">Prote√≠na <span class="arrow"></span></th>
                    <th>Por√ß√£o</th>
                    <th onclick="ordenar('custo')">Custo <span class="arrow"></span></th>
                    <th onclick="ordenar('custoProteina')">R$/g Prot. <span class="arrow active">‚¨á</span></th>
                </tr>
            </thead>
            <tbody id="tbody">
            </tbody>
        </table>
    </div>

    <div class="footer">
        <p>üí° Dica: Coxa de frango √© o melhor custo-benef√≠cio geral</p>
        <p>√öltimas atualiza√ß√£o: jan/2026</p>
    </div>

    <script>
        // Custo estimado para jan/2026. 
        // Whey: Considerando pre√ßo m√©dio de concentrado (~R$ 100/kg).
        // Barra: Considerando pre√ßo unit√°rio de mercado.
        const dados = [
            { fonte: 'Patinho bovino', categoria: 'carne', proteina: 35, porcao: '100g', custo: 4.5, custoProteina: 0.128 },
            { fonte: 'Fil√© mignon', categoria: 'carne', proteina: 33, porcao: '100g', custo: 8.0, custoProteina: 0.242 },
            { fonte: 'Contra-fil√©', categoria: 'carne', proteina: 32, porcao: '100g', custo: 6.0, custoProteina: 0.187 },
            { fonte: 'Miolo alcatra', categoria: 'carne', proteina: 33, porcao: '100g', custo: 5.5, custoProteina: 0.166 },
            { fonte: 'Maminha', categoria: 'carne', proteina: 31, porcao: '100g', custo: 5.0, custoProteina: 0.161 },
            { fonte: 'Lagarto', categoria: 'carne', proteina: 33, porcao: '100g', custo: 5.0, custoProteina: 0.151 },
            { fonte: 'Cox√£o mole', categoria: 'carne', proteina: 32, porcao: '100g', custo: 5.0, custoProteina: 0.156 },
            { fonte: 'Peito frango', categoria: 'frango', proteina: 32, porcao: '100g', custo: 1.5, custoProteina: 0.046 },
            { fonte: 'Coxa frango', categoria: 'frango', proteina: 27, porcao: '100g', custo: 1.2, custoProteina: 0.044 },
            { fonte: 'Coxinha da asa', categoria: 'frango', proteina: 19, porcao: '100g', custo: 1.5, custoProteina: 0.078 },
            { fonte: 'Til√°pia', categoria: 'peixe', proteina: 26, porcao: '100g', custo: 5.0, custoProteina: 0.192 },
            { fonte: 'Atum enlatado', categoria: 'peixe', proteina: 24, porcao: '100g', custo: 6.5, custoProteina: 0.270 },
            { fonte: 'Ovo inteiro cozido', categoria: 'outros', proteina: 13, porcao: '2 unidades', custo: 1.2, custoProteina: 0.092 },
            { fonte: 'Queijo cottage', categoria: 'outros', proteina: 12, porcao: '100g', custo: 3.5, custoProteina: 0.291 },
            { fonte: 'Whey Protein', categoria: 'suplemento', proteina: 24, porcao: '1 Scoop (30g)', custo: 3.5, custoProteina: 0.145 },
            { fonte: 'Barra Prote√≠na', categoria: 'suplemento', proteina: 12, porcao: '1 Unidade', custo: 8.0, custoProteina: 0.666 }
        ];

        let filtroAtual = '';
        let ordenacaoAtual = 'custoProteina';
        let direcaoOrdenacao = 'asc';

        function renderizarTabela(dataToRender = dados) {
            const tbody = document.getElementById('tbody');
            tbody.innerHTML = '';
            
            dataToRender.forEach((item, index) => {
                const row = document.createElement('tr');
                if (index === 0) row.classList.add('best');
                
                row.innerHTML = `
                    <td class="fonte-name">${item.fonte}</td>
                    <td class="proteina">${item.proteina}g</td>
                    <td class="porcao">${item.porcao}</td>
                    <td>R$ ${item.custo.toFixed(2)}</td>
                    <td class="custo-prot">R$ ${item.custoProteina.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });

            atualizarStats(dataToRender);
        }

        function ordenar(campo) {
            if (ordenacaoAtual === campo) {
                direcaoOrdenacao = direcaoOrdenacao === 'asc' ? 'desc' : 'asc';
            } else {
                ordenacaoAtual = campo;
                direcaoOrdenacao = 'asc';
            }

            const dataFiltrada = dados.filter(item => 
                filtroAtual === '' || item.categoria === filtroAtual
            );

            dataFiltrada.sort((a, b) => {
                let valA = a[campo];
                let valB = b[campo];

                if (typeof valA === 'string') {
                    return direcaoOrdenacao === 'asc' 
                        ? valA.localeCompare(valB) 
                        : valB.localeCompare(valA);
                }

                return direcaoOrdenacao === 'asc' 
                    ? valA - valB 
                    : valB - valA;
            });

            renderizarTabela(dataFiltrada);
            atualizarArrows(campo);
        }

        function atualizarArrows(campo) {
            document.querySelectorAll('th .arrow').forEach(arrow => {
                arrow.classList.remove('active');
                arrow.textContent = '';
            });

            const headers = document.querySelectorAll('th');
            headers.forEach(th => {
                if (th.textContent.toLowerCase().includes(campo === 'fonte' ? 'fonte' : 
                    campo === 'custo' ? 'custo' : 
                    campo === 'proteina' && !th.textContent.includes('R$') ? 'prote√≠na' : 
                    'r$/g')) {
                    
                    // Pequeno ajuste para garantir que pegamos o header certo
                    if (campo === 'proteina' && th.textContent.includes('R$')) return;
                    if (campo === 'custoProteina' && !th.textContent.includes('R$')) return;

                    const arrow = th.querySelector('.arrow');
                    if (arrow) {
                        arrow.classList.add('active');
                        arrow.textContent = direcaoOrdenacao === 'asc' ? '‚¨á' : '‚¨Ü';
                    }
                }
            });
        }

        function filtrarCategoria(categoria) {
            filtroAtual = categoria;
            ordenar(ordenacaoAtual);
        }

        function filtrarTabela() {
            const termo = document.getElementById('searchInput').value.toLowerCase();
            const dataFiltrada = dados.filter(item =>
                item.fonte.toLowerCase().includes(termo) &&
                (filtroAtual === '' || item.categoria === filtroAtual)
            );

            dataFiltrada.sort((a, b) => {
                let valA = a[ordenacaoAtual];
                let valB = b[ordenacaoAtual];
                return direcaoOrdenacao === 'asc' ? valA - valB : valB - valA;
            });

            renderizarTabela(dataFiltrada);
        }

        function calcularProteinaDiaria() { 
            const peso = parseFloat(document.getElementById('pesoUsuario').value); 
            if(!peso || peso < 30) { 
                document.getElementById('proteinaDiaria').textContent = '-'; 
                return; 
            } 
            const minimo = (peso * 1.6).toFixed(0); 
            const maximo = (peso * 2.2).toFixed(0); 
            document.getElementById('proteinaDiaria').textContent = minimo + '-' + maximo; 
        }

        function atualizarStats(dataToRender) {
            if (dataToRender.length === 0) return;
            const melhorCusto = Math.min(...dataToRender.map(d => d.custoProteina));
            const maiorProteina = Math.max(...dataToRender.map(d => d.proteina));

            document.getElementById('cheapest').textContent = `R$ ${melhorCusto.toFixed(2)}`;
            document.getElementById('best-protein').textContent = `${maiorProteina}g`;
        }

        function compartilharWhatsApp() {
            // Recalcula o Top 5 baseado nos dados atuais
            const top5 = [...dados].sort((a, b) => a.custoProteina - b.custoProteina).slice(0, 5);

            let textoTop5 = '';
            top5.forEach((item, index) => {
                textoTop5 += `${index + 1}Ô∏è‚É£ ${item.fonte}: R$${item.custoProteina.toFixed(2)}/g\n`;
            });

            const textoLimpo = 
                'ü•á *Prote√≠na Eficiente*\n\n' +
                'Top 5 Melhor Custo-Benef√≠cio (R$/g de prote√≠na):\n\n' +
                textoTop5 +
                '\nüí™ Compare Carnes, Ovos e Suplementos!\n\n' +
                'Acesse a tabela completa aqui üëá\n' + 
                window.location.href;

            const urlWhatsApp = `https://wa.me/?text=${encodeURIComponent(textoLimpo)}`;
            window.open(urlWhatsApp, '_blank');
        }

        // Inicializar
        renderizarTabela();
        atualizarArrows('custoProteina');
    </script>
</body>
</html>
