<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="description" content="ProteÃ­naMax PRO - O assistente de nutriÃ§Ã£o mais avanÃ§ado para atletas e praticantes de musculaÃ§Ã£o">
    <title>ProteÃ­naMax PRO - NutriÃ§Ã£o Inteligente</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* === DESIGN SYSTEM PRO === */
        :root {
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;

            /* Spacing Scale */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;

            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;

            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        :root[data-theme="dark"] {
            --primary: #10b981;
            --primary-rgb: 16, 185, 129;
            --primary-dark: #059669;
            --primary-light: rgba(16, 185, 129, 0.15);
            --primary-glow: rgba(16, 185, 129, 0.4);

            --secondary: #8b5cf6;
            --secondary-rgb: 139, 92, 246;
            --secondary-light: rgba(139, 92, 246, 0.15);

            --accent: #f59e0b;
            --accent-rgb: 245, 158, 11;
            --accent-light: rgba(245, 158, 11, 0.15);

            --danger: #ef4444;
            --danger-rgb: 239, 68, 68;
            --success: #22c55e;
            --warning: #eab308;

            --gold: #fbbf24;
            --gold-light: rgba(251, 191, 36, 0.15);

            --bg-base: #030712;
            --bg-elevated: #0f172a;
            --bg-surface: #1e293b;
            --bg-surface-2: #334155;
            --bg-hover: #475569;

            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --text-inverse: #0f172a;

            --border-default: rgba(148, 163, 184, 0.1);
            --border-hover: rgba(148, 163, 184, 0.2);
            --border-focus: var(--primary);

            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 24px 60px rgba(0, 0, 0, 0.6);
            --shadow-glow: 0 0 40px var(--primary-glow);
            --shadow-glow-gold: 0 0 30px rgba(251, 191, 36, 0.3);

            --glass-bg: rgba(15, 23, 42, 0.8);
            --glass-border: rgba(148, 163, 184, 0.1);

            --gradient-primary: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
            --gradient-secondary: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            --gradient-accent: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --gradient-gold: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
            --gradient-dark: linear-gradient(180deg, #0f172a 0%, #030712 100%);
            --gradient-radial: radial-gradient(ellipse at top, #1e293b 0%, #030712 70%);
            --gradient-mesh: radial-gradient(at 40% 20%, rgba(16, 185, 129, 0.15) 0px, transparent 50%),
                            radial-gradient(at 80% 0%, rgba(139, 92, 246, 0.1) 0px, transparent 50%),
                            radial-gradient(at 0% 50%, rgba(245, 158, 11, 0.1) 0px, transparent 50%);
        }

        :root[data-theme="light"] {
            --primary: #059669;
            --primary-rgb: 5, 150, 105;
            --primary-dark: #047857;
            --primary-light: rgba(5, 150, 105, 0.1);
            --primary-glow: rgba(5, 150, 105, 0.3);

            --secondary: #7c3aed;
            --secondary-rgb: 124, 58, 237;
            --secondary-light: rgba(124, 58, 237, 0.1);

            --accent: #d97706;
            --accent-rgb: 217, 119, 6;
            --accent-light: rgba(217, 119, 6, 0.1);

            --danger: #dc2626;
            --danger-rgb: 220, 38, 38;
            --success: #16a34a;
            --warning: #ca8a04;

            --gold: #d97706;
            --gold-light: rgba(217, 119, 6, 0.1);

            --bg-base: #f8fafc;
            --bg-elevated: #ffffff;
            --bg-surface: #f1f5f9;
            --bg-surface-2: #e2e8f0;
            --bg-hover: #cbd5e1;

            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-inverse: #f8fafc;

            --border-default: rgba(15, 23, 42, 0.08);
            --border-hover: rgba(15, 23, 42, 0.15);
            --border-focus: var(--primary);

            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 24px 60px rgba(0, 0, 0, 0.15);
            --shadow-glow: 0 0 40px var(--primary-glow);
            --shadow-glow-gold: 0 0 30px rgba(217, 119, 6, 0.2);

            --glass-bg: rgba(255, 255, 255, 0.9);
            --glass-border: rgba(15, 23, 42, 0.08);

            --gradient-primary: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --gradient-secondary: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            --gradient-accent: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --gradient-gold: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --gradient-dark: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            --gradient-radial: radial-gradient(ellipse at top, #ffffff 0%, #f1f5f9 70%);
            --gradient-mesh: radial-gradient(at 40% 20%, rgba(16, 185, 129, 0.08) 0px, transparent 50%),
                            radial-gradient(at 80% 0%, rgba(139, 92, 246, 0.05) 0px, transparent 50%),
                            radial-gradient(at 0% 50%, rgba(245, 158, 11, 0.05) 0px, transparent 50%);
        }

        /* === RESET & BASE === */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: var(--font-main);
            background: var(--gradient-radial), var(--bg-base);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-mesh);
            pointer-events: none;
            z-index: 0;
        }

        /* === TYPOGRAPHY === */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            color: var(--text-primary);
        }

        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .text-gradient-gold {
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* === SCROLLBAR === */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-surface-2);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* === LAYOUT === */
        .app-wrapper {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            padding-bottom: 100px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-md);
        }

        /* === GLASS MORPHISM === */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        /* === HEADER PRO === */
        .header-pro {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: var(--space-md) 0;
        }

        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md) var(--space-lg);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            border: 1px solid var(--glass-border);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-glow);
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: var(--shadow-glow); }
            50% { box-shadow: 0 0 60px var(--primary-glow); }
        }

        .logo-text h1 {
            font-size: 24px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .logo-text .pro-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: var(--gradient-gold);
            color: var(--text-inverse);
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: var(--radius-full);
            margin-left: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-glow-gold);
        }

        .logo-text p {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .streak-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            background: var(--gold-light);
            color: var(--gold);
            padding: 8px 14px;
            border-radius: var(--radius-full);
            font-weight: 700;
            font-size: 14px;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .streak-badge .fire {
            font-size: 18px;
            animation: fire-pulse 1s ease-in-out infinite;
        }

        @keyframes fire-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .xp-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            background: var(--secondary-light);
            color: var(--secondary);
            padding: 8px 14px;
            border-radius: var(--radius-full);
            font-weight: 700;
            font-size: 14px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .icon-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-default);
            background: var(--bg-surface);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .icon-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        /* === HERO SECTION === */
        .hero-section {
            padding: var(--space-xl) 0;
        }

        .hero-card {
            position: relative;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg), var(--shadow-glow);
        }

        .hero-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: var(--space-xl);
            align-items: center;
        }

        .hero-text h2 {
            font-size: 32px;
            font-weight: 800;
            color: white;
            margin-bottom: var(--space-sm);
        }

        .hero-text p {
            font-size: 16px;
            color: rgba(255,255,255,0.9);
            max-width: 500px;
        }

        .hero-stats {
            display: flex;
            gap: var(--space-lg);
        }

        .hero-stat {
            text-align: center;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            min-width: 120px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .hero-stat-value {
            font-size: 36px;
            font-weight: 800;
            color: white;
            line-height: 1;
        }

        .hero-stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.8);
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* === AI COACH === */
        .ai-coach-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            margin: var(--space-lg) 0;
            display: flex;
            align-items: flex-start;
            gap: var(--space-md);
            position: relative;
            overflow: hidden;
        }

        .ai-coach-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-secondary);
        }

        .ai-avatar {
            width: 56px;
            height: 56px;
            background: var(--gradient-secondary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            flex-shrink: 0;
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
        }

        .ai-content {
            flex: 1;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-sm);
        }

        .ai-name {
            font-weight: 700;
            color: var(--secondary);
        }

        .ai-badge {
            background: var(--secondary-light);
            color: var(--secondary);
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: var(--radius-full);
            text-transform: uppercase;
        }

        .ai-message {
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.6;
        }

        .ai-message strong {
            color: var(--text-primary);
        }

        /* === NAVIGATION TABS === */
        .nav-section {
            padding: var(--space-md) 0;
            position: sticky;
            top: 80px;
            z-index: 50;
        }

        .nav-tabs-pro {
            display: flex;
            gap: var(--space-sm);
            padding: var(--space-sm);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            border: 1px solid var(--glass-border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-tabs-pro::-webkit-scrollbar {
            display: none;
        }

        .nav-tab-pro {
            flex: 1;
            min-width: 100px;
            padding: var(--space-md) var(--space-lg);
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: var(--font-main);
            font-weight: 600;
            font-size: 14px;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-fast);
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            position: relative;
        }

        .nav-tab-pro:hover {
            color: var(--text-primary);
            background: var(--bg-surface);
        }

        .nav-tab-pro.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md), 0 0 20px var(--primary-glow);
        }

        .nav-tab-pro .tab-icon {
            font-size: 18px;
        }

        .nav-tab-pro .tab-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: var(--radius-full);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* === CONTENT SECTIONS === */
        .tab-content-pro {
            display: none;
            animation: fadeSlideIn 0.4s ease;
        }

        .tab-content-pro.active {
            display: block;
        }

        @keyframes fadeSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* === CARDS === */
        .card-pro {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            transition: all var(--transition-normal);
        }

        .card-pro:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-lg);
        }

        .card-pro-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .card-pro-title {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 18px;
            font-weight: 700;
        }

        .card-pro-title .icon {
            font-size: 24px;
        }

        /* === STATS GRID === */
        .stats-grid-pro {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-md);
        }

        .stat-card-pro {
            position: relative;
            padding: var(--space-lg);
            border-radius: var(--radius-xl);
            overflow: hidden;
            transition: all var(--transition-normal);
        }

        .stat-card-pro::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            transition: opacity var(--transition-fast);
        }

        .stat-card-pro:hover {
            transform: translateY(-4px);
        }

        .stat-card-pro:hover::before {
            opacity: 0.15;
        }

        .stat-card-pro.protein {
            background: var(--primary-light);
            border: 1px solid rgba(var(--primary-rgb), 0.2);
        }

        .stat-card-pro.protein::before {
            background: var(--gradient-primary);
        }

        .stat-card-pro.carbs {
            background: var(--accent-light);
            border: 1px solid rgba(var(--accent-rgb), 0.2);
        }

        .stat-card-pro.carbs::before {
            background: var(--gradient-accent);
        }

        .stat-card-pro.fat {
            background: rgba(var(--danger-rgb), 0.1);
            border: 1px solid rgba(var(--danger-rgb), 0.2);
        }

        .stat-card-pro.calories {
            background: var(--secondary-light);
            border: 1px solid rgba(var(--secondary-rgb), 0.2);
        }

        .stat-card-pro.calories::before {
            background: var(--gradient-secondary);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: var(--space-sm);
        }

        .stat-value-pro {
            font-size: 32px;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 4px;
        }

        .stat-card-pro.protein .stat-value-pro { color: var(--primary); }
        .stat-card-pro.carbs .stat-value-pro { color: var(--accent); }
        .stat-card-pro.fat .stat-value-pro { color: var(--danger); }
        .stat-card-pro.calories .stat-value-pro { color: var(--secondary); }

        .stat-label-pro {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-sub {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* === PROGRESS RING === */
        .progress-ring-container {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: var(--space-lg);
        }

        .progress-ring {
            position: relative;
            width: 200px;
            height: 200px;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
        }

        .progress-ring-bg {
            fill: none;
            stroke: var(--bg-surface-2);
            stroke-width: 12;
        }

        .progress-ring-fill {
            fill: none;
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }

        .progress-ring-fill.protein { stroke: var(--primary); }
        .progress-ring-fill.carbs { stroke: var(--accent); }
        .progress-ring-fill.fat { stroke: var(--danger); }

        .progress-ring-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .progress-ring-value {
            font-size: 36px;
            font-weight: 800;
        }

        .progress-ring-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* === FORMS === */
        .form-group-pro {
            margin-bottom: var(--space-lg);
        }

        .form-label-pro {
            display: block;
            font-weight: 600;
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .form-label-pro .required {
            color: var(--danger);
        }

        .form-input-pro, .form-select-pro {
            width: 100%;
            padding: var(--space-md);
            background: var(--bg-base);
            border: 2px solid var(--border-default);
            border-radius: var(--radius-lg);
            color: var(--text-primary);
            font-family: var(--font-main);
            font-size: 15px;
            font-weight: 500;
            transition: all var(--transition-fast);
            outline: none;
        }

        .form-input-pro:focus, .form-select-pro:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-light);
        }

        .form-input-pro::placeholder {
            color: var(--text-muted);
        }

        .form-row-pro {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon .input-icon {
            position: absolute;
            left: var(--space-md);
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            color: var(--text-muted);
        }

        .input-with-icon .form-input-pro {
            padding-left: 48px;
        }

        /* === BUTTONS === */
        .btn-pro {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            font-family: var(--font-main);
            font-weight: 600;
            font-size: 15px;
            border-radius: var(--radius-lg);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
        }

        .btn-pro:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary-pro {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md), 0 0 20px var(--primary-glow);
        }

        .btn-primary-pro:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg), 0 0 30px var(--primary-glow);
        }

        .btn-secondary-pro {
            background: var(--gradient-secondary);
            color: white;
        }

        .btn-secondary-pro:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline-pro {
            background: transparent;
            border: 2px solid var(--border-default);
            color: var(--text-primary);
        }

        .btn-outline-pro:hover:not(:disabled) {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
        }

        .btn-gold {
            background: var(--gradient-gold);
            color: var(--text-inverse);
            box-shadow: var(--shadow-glow-gold);
        }

        .btn-full {
            width: 100%;
        }

        .btn-lg {
            padding: var(--space-lg) var(--space-2xl);
            font-size: 16px;
        }

        /* === TABLE === */
        .table-wrapper-pro {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-default);
        }

        .table-pro {
            width: 100%;
            border-collapse: collapse;
        }

        .table-pro th {
            background: var(--bg-surface-2);
            padding: var(--space-md);
            text-align: left;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            position: sticky;
            top: 0;
            cursor: pointer;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }

        .table-pro th:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .table-pro td {
            padding: var(--space-md);
            border-bottom: 1px solid var(--border-default);
            font-size: 14px;
        }

        .table-pro tr:hover td {
            background: var(--bg-surface);
        }

        .table-pro tr:last-child td {
            border-bottom: none;
        }

        /* === BADGES === */
        .badge-pro {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .badge-carne { background: rgba(220, 38, 38, 0.15); color: #ef4444; }
        .badge-frango { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .badge-peixe { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
        .badge-laticinio { background: rgba(6, 182, 212, 0.15); color: #06b6d4; }
        .badge-vegetal { background: rgba(34, 197, 94, 0.15); color: #22c55e; }
        .badge-suplemento { background: rgba(168, 85, 247, 0.15); color: #a855f7; }
        .badge-outros { background: rgba(107, 114, 128, 0.15); color: #9ca3af; }

        /* === FAVORITE BUTTON === */
        .fav-btn {
            background: none;
            border: none;
            font-size: 22px;
            cursor: pointer;
            transition: all var(--transition-fast);
            padding: 4px;
        }

        .fav-btn:hover {
            transform: scale(1.2);
        }

        .fav-btn.active {
            animation: pop 0.3s ease;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.4); }
            100% { transform: scale(1); }
        }

        /* === FILTER CHIPS === */
        .filter-chips {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
            margin-bottom: var(--space-lg);
        }

        .chip {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-full);
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .chip:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .chip.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* === MEAL PLANNER === */
        .meal-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-md);
            overflow: hidden;
            transition: all var(--transition-normal);
        }

        .meal-card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 0 1px var(--primary);
        }

        .meal-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md) var(--space-lg);
            background: var(--bg-surface-2);
            border-bottom: 1px solid var(--border-default);
        }

        .meal-title {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 700;
        }

        .meal-title .emoji {
            font-size: 24px;
        }

        .meal-weight-badge {
            background: var(--primary-light);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
        }

        .meal-card-body {
            padding: var(--space-lg);
        }

        /* === RECIPE CARDS === */
        .recipes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
        }

        .recipe-card-pro {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            overflow: hidden;
            transition: all var(--transition-normal);
        }

        .recipe-card-pro:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .recipe-header-pro {
            background: var(--gradient-primary);
            padding: var(--space-lg);
            position: relative;
        }

        .recipe-header-pro h3 {
            color: white;
            font-size: 18px;
            margin-bottom: 4px;
        }

        .recipe-time {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: rgba(255,255,255,0.9);
            font-size: 13px;
        }

        .recipe-body-pro {
            padding: var(--space-lg);
        }

        .recipe-macros-pro {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .recipe-macro {
            text-align: center;
            padding: var(--space-sm);
            background: var(--bg-base);
            border-radius: var(--radius-md);
        }

        .recipe-macro-value {
            font-size: 18px;
            font-weight: 700;
        }

        .recipe-macro-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .recipe-details {
            display: none;
            margin-top: var(--space-md);
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-default);
        }

        .recipe-details.show {
            display: block;
            animation: fadeSlideIn 0.3s ease;
        }

        .recipe-details h4 {
            font-size: 14px;
            margin-bottom: var(--space-sm);
            color: var(--primary);
        }

        .recipe-details ul {
            margin-left: var(--space-lg);
            color: var(--text-secondary);
            font-size: 14px;
        }

        .recipe-details ul li {
            margin-bottom: 4px;
        }

        /* === HISTORY === */
        .history-item-pro {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .history-item-pro:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-sm);
        }

        .history-date {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .history-macros {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* === COMPARE CARDS === */
        .compare-grid-pro {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
        }

        .compare-card-pro {
            background: var(--bg-surface);
            border: 2px solid var(--border-default);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            text-align: center;
            transition: all var(--transition-normal);
        }

        .compare-card-pro.winner {
            border-color: var(--primary);
            background: linear-gradient(180deg, var(--primary-light) 0%, var(--bg-surface) 100%);
            box-shadow: var(--shadow-glow);
        }

        .compare-card-pro .trophy {
            font-size: 48px;
            margin-bottom: var(--space-sm);
        }

        .compare-card-pro h4 {
            font-size: 18px;
            margin-bottom: var(--space-lg);
        }

        .compare-stat {
            display: flex;
            justify-content: space-between;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--border-default);
        }

        .compare-stat:last-child {
            border-bottom: none;
        }

        .compare-stat.highlight {
            color: var(--primary);
            font-weight: 600;
        }

        /* === EMPTY STATE === */
        .empty-state-pro {
            text-align: center;
            padding: var(--space-3xl);
            color: var(--text-muted);
        }

        .empty-state-pro .icon {
            font-size: 64px;
            margin-bottom: var(--space-md);
            opacity: 0.3;
        }

        .empty-state-pro h3 {
            color: var(--text-secondary);
            margin-bottom: var(--space-sm);
        }

        .empty-state-pro p {
            font-size: 14px;
        }

        /* === TOAST NOTIFICATIONS === */
        .toast-container {
            position: fixed;
            bottom: 100px;
            right: var(--space-lg);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .toast {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            box-shadow: var(--shadow-lg);
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
            min-width: 280px;
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.warning { border-left: 4px solid var(--warning); }

        .toast-icon {
            font-size: 24px;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 14px;
        }

        .toast-message {
            font-size: 13px;
            color: var(--text-secondary);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateY(10px);
            }
        }

        /* === BOTTOM NAVIGATION (Mobile) === */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            padding: var(--space-sm) var(--space-md);
            padding-bottom: calc(var(--space-sm) + env(safe-area-inset-bottom));
            display: none;
            z-index: 100;
        }

        .bottom-nav-items {
            display: flex;
            justify-content: space-around;
            max-width: 500px;
            margin: 0 auto;
        }

        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: var(--space-sm);
            color: var(--text-muted);
            font-size: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: none;
            background: none;
        }

        .bottom-nav-item .nav-icon {
            font-size: 24px;
            transition: all var(--transition-fast);
        }

        .bottom-nav-item.active {
            color: var(--primary);
        }

        .bottom-nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        /* === ONBOARDING MODAL === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: var(--space-lg);
        }

        .modal-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.4s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-header {
            padding: var(--space-xl);
            text-align: center;
            border-bottom: 1px solid var(--border-default);
        }

        .modal-header .modal-icon {
            font-size: 64px;
            margin-bottom: var(--space-md);
        }

        .modal-header h2 {
            font-size: 24px;
            margin-bottom: var(--space-sm);
        }

        .modal-header p {
            color: var(--text-secondary);
        }

        .modal-body {
            padding: var(--space-xl);
        }

        .modal-footer {
            padding: var(--space-lg) var(--space-xl);
            border-top: 1px solid var(--border-default);
            display: flex;
            gap: var(--space-md);
        }

        /* === ACHIEVEMENTS === */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: var(--space-md);
        }

        .achievement-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            transition: all var(--transition-normal);
        }

        .achievement-card.unlocked {
            border-color: var(--gold);
            background: var(--gold-light);
        }

        .achievement-card.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .achievement-icon {
            font-size: 40px;
            margin-bottom: var(--space-sm);
        }

        .achievement-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .achievement-desc {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* === SHOPPING LIST === */
        .shopping-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-surface);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            transition: all var(--transition-fast);
        }

        .shopping-item:hover {
            border-color: var(--primary);
        }

        .shopping-item.checked {
            opacity: 0.5;
            text-decoration: line-through;
        }

        .shopping-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-default);
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            flex-shrink: 0;
        }

        .shopping-checkbox.checked {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--space-sm);
            }

            .header-inner {
                padding: var(--space-sm) var(--space-md);
            }

            .logo-icon {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }

            .logo-text h1 {
                font-size: 18px;
            }

            .logo-text p {
                display: none;
            }

            .streak-badge, .xp-badge {
                padding: 6px 10px;
                font-size: 12px;
            }

            .hero-card {
                padding: var(--space-lg);
            }

            .hero-content {
                grid-template-columns: 1fr;
            }

            .hero-text h2 {
                font-size: 24px;
            }

            .hero-stats {
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero-stat {
                min-width: 100px;
                padding: var(--space-md);
            }

            .hero-stat-value {
                font-size: 28px;
            }

            .nav-section {
                top: 70px;
            }

            .nav-tabs-pro {
                display: none;
            }

            .bottom-nav {
                display: block;
            }

            .app-wrapper {
                padding-bottom: 80px;
            }

            .stats-grid-pro {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-card-pro {
                padding: var(--space-md);
            }

            .stat-value-pro {
                font-size: 24px;
            }

            .form-row-pro {
                grid-template-columns: 1fr;
            }

            .recipes-grid {
                grid-template-columns: 1fr;
            }

            .toast-container {
                left: var(--space-md);
                right: var(--space-md);
                bottom: 90px;
            }

            .toast {
                min-width: auto;
            }
        }

        @media (max-width: 480px) {
            .stats-grid-pro {
                grid-template-columns: 1fr;
            }

            .ai-coach-card {
                flex-direction: column;
                text-align: center;
            }

            .ai-coach-card::before {
                width: 100%;
                height: 4px;
                left: 0;
                top: 0;
            }

            .ai-header {
                justify-content: center;
            }
        }

        /* === LOADING SKELETON === */
        .skeleton {
            background: linear-gradient(90deg, var(--bg-surface) 25%, var(--bg-surface-2) 50%, var(--bg-surface) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: var(--radius-md);
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* === PRINT STYLES === */
        @media print {
            .header-pro, .nav-section, .bottom-nav, .btn-pro {
                display: none !important;
            }

            body {
                background: white;
                color: black;
            }

            .card-pro {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <!-- HEADER -->
        <header class="header-pro">
            <div class="container">
                <div class="header-inner">
                    <div class="logo-section">
                        <div class="logo-icon">ðŸ’ª</div>
                        <div class="logo-text">
                            <h1>ProteÃ­naMax<span class="pro-badge">âœ¨ PRO</span></h1>
                            <p>NutriÃ§Ã£o Inteligente para Atletas</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <div class="streak-badge">
                            <span class="fire">ðŸ”¥</span>
                            <span id="streak-count">0</span> dias
                        </div>
                        <div class="xp-badge">
                            <span>âš¡</span>
                            <span id="xp-count">0</span> XP
                        </div>
                        <button class="icon-btn" onclick="toggleTheme()" title="Alternar tema">
                            <span id="theme-icon">ðŸŒ™</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <!-- HERO SECTION -->
            <section class="hero-section">
                <div class="hero-card">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h2>Bem-vindo de volta! ðŸ‘‹</h2>
                            <p id="hero-message">Configure seus dados na calculadora para comeÃ§ar sua jornada de transformaÃ§Ã£o.</p>
                        </div>
                        <div class="hero-stats">
                            <div class="hero-stat">
                                <div class="hero-stat-value" id="hero-protein">-</div>
                                <div class="hero-stat-label">ProteÃ­na/dia</div>
                            </div>
                            <div class="hero-stat">
                                <div class="hero-stat-value" id="hero-calories">-</div>
                                <div class="hero-stat-label">Calorias</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI COACH -->
            <div class="ai-coach-card" id="ai-coach">
                <div class="ai-avatar">ðŸ¤–</div>
                <div class="ai-content">
                    <div class="ai-header">
                        <span class="ai-name">Max Coach</span>
                        <span class="ai-badge">IA</span>
                    </div>
                    <div class="ai-message" id="ai-message">
                        OlÃ¡! Sou o <strong>Max</strong>, seu coach de nutriÃ§Ã£o. Para personalizar suas recomendaÃ§Ãµes, preencha seus dados na <strong>Calculadora</strong>. Vamos juntos alcanÃ§ar seus objetivos! ðŸ’ª
                    </div>
                </div>
            </div>

            <!-- NAVIGATION TABS -->
            <nav class="nav-section">
                <div class="nav-tabs-pro">
                    <button class="nav-tab-pro active" onclick="switchTab('dashboard')" data-tab="dashboard">
                        <span class="tab-icon">ðŸ“Š</span>
                        Dashboard
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('calculator')" data-tab="calculator">
                        <span class="tab-icon">ðŸ§®</span>
                        Calculadora
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('foods')" data-tab="foods">
                        <span class="tab-icon">ðŸ¥—</span>
                        Alimentos
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('planner')" data-tab="planner">
                        <span class="tab-icon">ðŸ“…</span>
                        Planejador
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('recipes')" data-tab="recipes">
                        <span class="tab-icon">ðŸ‘¨â€ðŸ³</span>
                        Receitas
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('shopping')" data-tab="shopping">
                        <span class="tab-icon">ðŸ›’</span>
                        Compras
                    </button>
                    <button class="nav-tab-pro" onclick="switchTab('history')" data-tab="history">
                        <span class="tab-icon">ðŸ“œ</span>
                        HistÃ³rico
                    </button>
                </div>
            </nav>

            <!-- TAB: DASHBOARD -->
            <section id="tab-dashboard" class="tab-content-pro active">
                <div class="stats-grid-pro">
                    <div class="stat-card-pro protein">
                        <div class="stat-icon">ðŸ¥©</div>
                        <div class="stat-value-pro"><span id="dash-protein">-</span>g</div>
                        <div class="stat-label-pro">ProteÃ­na DiÃ¡ria</div>
                        <div class="stat-sub">Meta para hipertrofia</div>
                    </div>
                    <div class="stat-card-pro carbs">
                        <div class="stat-icon">ðŸš</div>
                        <div class="stat-value-pro"><span id="dash-carbs">-</span>g</div>
                        <div class="stat-label-pro">Carboidratos</div>
                        <div class="stat-sub">Energia para treinos</div>
                    </div>
                    <div class="stat-card-pro fat">
                        <div class="stat-icon">ðŸ¥‘</div>
                        <div class="stat-value-pro"><span id="dash-fat">-</span>g</div>
                        <div class="stat-label-pro">Gorduras</div>
                        <div class="stat-sub">HormÃ´nios e saÃºde</div>
                    </div>
                    <div class="stat-card-pro calories">
                        <div class="stat-icon">ðŸ”¥</div>
                        <div class="stat-value-pro"><span id="dash-calories">-</span></div>
                        <div class="stat-label-pro">Calorias Totais</div>
                        <div class="stat-sub">TDEE calculado</div>
                    </div>
                </div>

                <!-- Conquistas -->
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ†</span>
                            Conquistas
                        </h3>
                        <span style="font-size: 13px; color: var(--text-secondary);"><span id="achievements-count">0</span>/10 desbloqueadas</span>
                    </div>
                    <div class="achievements-grid" id="achievements-grid"></div>
                </div>

                <!-- Favoritos -->
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">â­</span>
                            Seus Favoritos
                        </h3>
                    </div>
                    <div id="favorites-list"></div>
                </div>
            </section>

            <!-- TAB: CALCULATOR -->
            <section id="tab-calculator" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ§®</span>
                            Calculadora de Macros AvanÃ§ada
                        </h3>
                    </div>

                    <div class="form-row-pro">
                        <div class="form-group-pro">
                            <label class="form-label-pro">âš–ï¸ Peso (kg) <span class="required">*</span></label>
                            <input type="number" class="form-input-pro" id="calc-weight" placeholder="Ex: 75" min="30" max="300">
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">ðŸ“ Altura (cm) <span class="required">*</span></label>
                            <input type="number" class="form-input-pro" id="calc-height" placeholder="Ex: 175" min="100" max="250">
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">ðŸŽ‚ Idade <span class="required">*</span></label>
                            <input type="number" class="form-input-pro" id="calc-age" placeholder="Ex: 25" min="14" max="100">
                        </div>
                    </div>

                    <div class="form-row-pro">
                        <div class="form-group-pro">
                            <label class="form-label-pro">âš§ Sexo BiolÃ³gico</label>
                            <select class="form-select-pro" id="calc-gender">
                                <option value="male">Masculino</option>
                                <option value="female">Feminino</option>
                            </select>
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">ðŸƒ NÃ­vel de Atividade</label>
                            <select class="form-select-pro" id="calc-activity">
                                <option value="1.2">SedentÃ¡rio (pouco/nenhum exercÃ­cio)</option>
                                <option value="1.375">Leve (1-3x por semana)</option>
                                <option value="1.55" selected>Moderado (3-5x por semana)</option>
                                <option value="1.725">Intenso (6-7x por semana)</option>
                                <option value="1.9">Muito Intenso (2x por dia)</option>
                            </select>
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">ðŸŽ¯ Objetivo</label>
                            <select class="form-select-pro" id="calc-goal">
                                <option value="cutting">ðŸ”¥ Cutting (Perda de Gordura)</option>
                                <option value="maintenance">âš–ï¸ ManutenÃ§Ã£o</option>
                                <option value="bulking" selected>ðŸ’ª Bulking (Ganho de Massa)</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn-pro btn-primary-pro btn-full btn-lg" onclick="calculateMacros()">
                        ðŸ§® Calcular Meus Macros
                    </button>

                    <div id="macro-results" style="display: none; margin-top: var(--space-xl);">
                        <div style="text-align: center; margin-bottom: var(--space-lg);">
                            <h3 class="text-gradient" style="font-size: 24px;">âœ… Seus Macros Personalizados</h3>
                            <p style="color: var(--text-secondary);">Baseado na fÃ³rmula Mifflin-St Jeor + diretrizes ISSN</p>
                        </div>

                        <div class="stats-grid-pro" style="margin-bottom: var(--space-xl);">
                            <div class="stat-card-pro calories">
                                <div class="stat-label-pro">TMB</div>
                                <div class="stat-value-pro"><span id="result-tmb">-</span></div>
                                <div class="stat-sub">Taxa MetabÃ³lica Basal</div>
                            </div>
                            <div class="stat-card-pro calories">
                                <div class="stat-label-pro">TDEE</div>
                                <div class="stat-value-pro"><span id="result-tdee">-</span></div>
                                <div class="stat-sub">Gasto CalÃ³rico Total</div>
                            </div>
                            <div class="stat-card-pro protein">
                                <div class="stat-label-pro">Meta CalÃ³rica</div>
                                <div class="stat-value-pro"><span id="result-calories">-</span></div>
                                <div class="stat-sub">Para seu objetivo</div>
                            </div>
                        </div>

                        <div class="card-pro" style="background: var(--bg-base);">
                            <h4 style="margin-bottom: var(--space-lg); text-align: center;">ðŸ“Š DistribuiÃ§Ã£o DiÃ¡ria de Macros</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg); text-align: center;">
                                <div>
                                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 4px;">ðŸ¥© ProteÃ­nas</div>
                                    <div style="font-size: 36px; font-weight: 800; color: var(--primary);"><span id="result-protein">-</span>g</div>
                                    <div style="font-size: 12px; color: var(--text-muted);"><span id="result-protein-cal">-</span> kcal</div>
                                </div>
                                <div>
                                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 4px;">ðŸš Carboidratos</div>
                                    <div style="font-size: 36px; font-weight: 800; color: var(--accent);"><span id="result-carbs">-</span>g</div>
                                    <div style="font-size: 12px; color: var(--text-muted);"><span id="result-carbs-cal">-</span> kcal</div>
                                </div>
                                <div>
                                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 4px;">ðŸ¥‘ Gorduras</div>
                                    <div style="font-size: 36px; font-weight: 800; color: var(--danger);"><span id="result-fat">-</span>g</div>
                                    <div style="font-size: 12px; color: var(--text-muted);"><span id="result-fat-cal">-</span> kcal</div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: var(--space-lg); padding: var(--space-md); background: var(--primary-light); border-radius: var(--radius-lg); border-left: 4px solid var(--primary);">
                            <p style="font-size: 13px; color: var(--text-secondary);">
                                <strong style="color: var(--primary);">ðŸ“š Base CientÃ­fica:</strong> FÃ³rmula Mifflin-St Jeor (1990) para TMB, multiplicadores Harris-Benedict para TDEE, e recomendaÃ§Ãµes ISSN (2017) para distribuiÃ§Ã£o de macros em atletas.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: FOODS -->
            <section id="tab-foods" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ¥—</span>
                            Base de Alimentos
                        </h3>
                        <span style="font-size: 13px; color: var(--text-secondary);">32 alimentos</span>
                    </div>

                    <input type="text" class="form-input-pro" id="food-search" placeholder="ðŸ” Buscar alimento..." onkeyup="filterFoods()" style="margin-bottom: var(--space-md);">

                    <div class="filter-chips">
                        <button class="chip active" onclick="filterByCategory('')">Todos</button>
                        <button class="chip" onclick="filterByCategory('carne')">ðŸ¥© Carne</button>
                        <button class="chip" onclick="filterByCategory('frango')">ðŸ— Frango</button>
                        <button class="chip" onclick="filterByCategory('peixe')">ðŸŸ Peixe</button>
                        <button class="chip" onclick="filterByCategory('laticinio')">ðŸ¥› LaticÃ­nio</button>
                        <button class="chip" onclick="filterByCategory('vegetal')">ðŸŒ± Vegetal</button>
                        <button class="chip" onclick="filterByCategory('suplemento')">âš¡ Suplemento</button>
                    </div>

                    <div class="table-wrapper-pro">
                        <table class="table-pro" id="foods-table">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('nome')">Alimento â†•</th>
                                    <th onclick="sortTable('proteina')">Prot. â†•</th>
                                    <th onclick="sortTable('carbs')">Carb. â†•</th>
                                    <th onclick="sortTable('gordura')">Gord. â†•</th>
                                    <th onclick="sortTable('calorias')">Kcal â†•</th>
                                    <th onclick="sortTable('custo')">R$ â†•</th>
                                    <th>Fav</th>
                                </tr>
                            </thead>
                            <tbody id="foods-tbody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- COMPARADOR -->
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">âš–ï¸</span>
                            Comparador de Alimentos
                        </h3>
                    </div>

                    <div class="form-row-pro">
                        <div class="form-group-pro">
                            <label class="form-label-pro">Alimento 1</label>
                            <select class="form-select-pro" id="compare-food-1"></select>
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">Alimento 2</label>
                            <select class="form-select-pro" id="compare-food-2"></select>
                        </div>
                        <div class="form-group-pro">
                            <label class="form-label-pro">Alimento 3 (opcional)</label>
                            <select class="form-select-pro" id="compare-food-3"></select>
                        </div>
                    </div>

                    <button class="btn-pro btn-secondary-pro btn-full" onclick="compareFoods()">
                        âš–ï¸ Comparar Alimentos
                    </button>

                    <div id="compare-results" style="margin-top: var(--space-lg);"></div>
                </div>
            </section>

            <!-- TAB: PLANNER -->
            <section id="tab-planner" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ“…</span>
                            Planejador Inteligente de RefeiÃ§Ãµes
                        </h3>
                    </div>

                    <div style="background: var(--primary-light); padding: var(--space-md); border-radius: var(--radius-lg); margin-bottom: var(--space-lg); border-left: 4px solid var(--primary);">
                        <p style="font-size: 14px; color: var(--text-secondary);">
                            <strong style="color: var(--primary);">ðŸ’¡ Como funciona:</strong> Selecione suas proteÃ­nas favoritas para cada refeiÃ§Ã£o. O sistema calcularÃ¡ automaticamente as quantidades ideais e sugerirÃ¡ carboidratos e gorduras complementares.
                        </p>
                    </div>

                    <div id="meal-planner-container"></div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md); margin-top: var(--space-lg);">
                        <button class="btn-pro btn-gold btn-lg" onclick="generateAutoPlan()">
                            âœ¨ Planejamento AutomÃ¡tico
                        </button>
                        <button class="btn-pro btn-primary-pro btn-lg" onclick="calculateSmartMealPlan()">
                            ðŸ§® Gerar Plano Manual
                        </button>
                    </div>

                    <div style="background: var(--gold-light); padding: var(--space-md); border-radius: var(--radius-lg); margin-top: var(--space-md); border-left: 4px solid var(--gold);">
                        <p style="font-size: 13px; color: var(--text-secondary);">
                            <strong style="color: var(--gold);">âœ¨ Planejamento AutomÃ¡tico:</strong> Usa seus <strong>alimentos favoritos</strong> para criar um plano realista e equilibrado automaticamente. Adicione favoritos na aba Alimentos!
                        </p>
                    </div>

                    <div id="plan-results" style="display: none; margin-top: var(--space-xl);"></div>
                </div>
            </section>

            <!-- TAB: RECIPES -->
            <section id="tab-recipes" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ‘¨â€ðŸ³</span>
                            Receitas Proteicas
                        </h3>
                        <span style="font-size: 13px; color: var(--text-secondary);">10 receitas</span>
                    </div>
                    <div class="recipes-grid" id="recipes-list"></div>
                </div>
            </section>

            <!-- TAB: SHOPPING -->
            <section id="tab-shopping" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ›’</span>
                            Lista de Compras Inteligente
                        </h3>
                        <button class="btn-pro btn-outline-pro" onclick="generateShoppingList()" style="padding: 8px 16px; font-size: 13px;">
                            ðŸ”„ Gerar do Plano
                        </button>
                    </div>
                    <div id="shopping-list">
                        <div class="empty-state-pro">
                            <div class="icon">ðŸ›’</div>
                            <h3>Lista vazia</h3>
                            <p>Gere um plano alimentar para criar sua lista de compras automaticamente.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: HISTORY -->
            <section id="tab-history" class="tab-content-pro">
                <div class="card-pro">
                    <div class="card-pro-header">
                        <h3 class="card-pro-title">
                            <span class="icon">ðŸ“œ</span>
                            HistÃ³rico de Planos
                        </h3>
                        <button class="btn-pro btn-outline-pro" onclick="clearHistory()" style="padding: 8px 16px; font-size: 13px;">
                            ðŸ—‘ï¸ Limpar
                        </button>
                    </div>
                    <div id="history-list"></div>
                </div>
                <div id="history-details" style="display: none;"></div>
            </section>
        </main>

        <!-- BOTTOM NAVIGATION (Mobile) -->
        <nav class="bottom-nav">
            <div class="bottom-nav-items">
                <button class="bottom-nav-item active" onclick="switchTab('dashboard')" data-tab="dashboard">
                    <span class="nav-icon">ðŸ“Š</span>
                    <span>Dashboard</span>
                </button>
                <button class="bottom-nav-item" onclick="switchTab('calculator')" data-tab="calculator">
                    <span class="nav-icon">ðŸ§®</span>
                    <span>Calcular</span>
                </button>
                <button class="bottom-nav-item" onclick="switchTab('foods')" data-tab="foods">
                    <span class="nav-icon">ðŸ¥—</span>
                    <span>Alimentos</span>
                </button>
                <button class="bottom-nav-item" onclick="switchTab('planner')" data-tab="planner">
                    <span class="nav-icon">ðŸ“…</span>
                    <span>Planejar</span>
                </button>
                <button class="bottom-nav-item" onclick="switchTab('history')" data-tab="history">
                    <span class="nav-icon">ðŸ“œ</span>
                    <span>HistÃ³rico</span>
                </button>
            </div>
        </nav>

        <!-- TOAST CONTAINER -->
        <div class="toast-container" id="toast-container"></div>
    </div>

    <script>
        // === PROTEÃNAMAX PRO - SISTEMA COMPLETO ===

        // === CONFIGURAÃ‡Ã•ES DE UNIDADES E LIMITES REALISTAS ===
        const foodUnits = {
            'Whey Protein': { unit: 'scoop', gramsPerUnit: 30, maxUnits: 2, displayName: 'scoop' },
            'Albumina': { unit: 'scoop', gramsPerUnit: 30, maxUnits: 2, displayName: 'scoop' },
            'CaseÃ­na': { unit: 'scoop', gramsPerUnit: 30, maxUnits: 2, displayName: 'scoop' },
            'Ovo Inteiro Cozido': { unit: 'unidade', gramsPerUnit: 50, maxUnits: 3, displayName: 'unidade' },
            'Clara de Ovo': { unit: 'unidade', gramsPerUnit: 33, maxUnits: 6, displayName: 'clara' },
            'Ovo Mexido': { unit: 'unidade', gramsPerUnit: 50, maxUnits: 3, displayName: 'unidade' },
            'Queijo Cottage': { unit: 'colher', gramsPerUnit: 25, maxUnits: 2, displayName: 'colher de sopa' },
            'Atum Enlatado': { unit: 'gramas', gramsPerUnit: 1, maxUnits: 100, displayName: 'g' },
            'Pasta de Amendoim': { unit: 'colher', gramsPerUnit: 15, maxUnits: 2, displayName: 'colher de sopa' },
            // Alimentos Centro-Oeste
            'LinguiÃ§a Cuiabana': { unit: 'unidade', gramsPerUnit: 50, maxUnits: 2, displayName: 'unidade' },
            'RequeijÃ£o Cremoso': { unit: 'colher', gramsPerUnit: 25, maxUnits: 2, displayName: 'colher de sopa' },
            'Queijo Coalho': { unit: 'fatia', gramsPerUnit: 40, maxUnits: 2, displayName: 'fatia' },
            'Queijo Meia Cura': { unit: 'fatia', gramsPerUnit: 30, maxUnits: 2, displayName: 'fatia' },
            'Moela de Frango': { unit: 'porÃ§Ã£o', gramsPerUnit: 100, maxUnits: 1.5, displayName: 'porÃ§Ã£o' },
            'CoraÃ§Ã£o de Frango': { unit: 'porÃ§Ã£o', gramsPerUnit: 100, maxUnits: 1.5, displayName: 'porÃ§Ã£o' },
            'FÃ­gado de Frango': { unit: 'porÃ§Ã£o', gramsPerUnit: 100, maxUnits: 1, displayName: 'porÃ§Ã£o' },
        };

        // === DADOS COMPLETOS ===
        const foodsDatabase = [
            { id: 1, nome: 'Patinho Bovino', categoria: 'carne', proteina: 35, carbs: 0, gordura: 3, calorias: 171, custo: 4.5, porcao: '100g' },
            { id: 2, nome: 'FilÃ© Mignon', categoria: 'carne', proteina: 33, carbs: 0, gordura: 8, calorias: 213, custo: 8.0, porcao: '100g' },
            { id: 3, nome: 'Contra-FilÃ©', categoria: 'carne', proteina: 32, carbs: 0, gordura: 10, calorias: 234, custo: 6.0, porcao: '100g' },
            { id: 4, nome: 'Alcatra', categoria: 'carne', proteina: 33, carbs: 0, gordura: 6, calorias: 195, custo: 5.5, porcao: '100g' },
            { id: 5, nome: 'Picanha', categoria: 'carne', proteina: 31, carbs: 0, gordura: 12, calorias: 248, custo: 9.0, porcao: '100g' },
            { id: 6, nome: 'Peito de Frango Grelhado', categoria: 'frango', proteina: 32, carbs: 0, gordura: 3, calorias: 159, custo: 1.5, porcao: '100g' },
            { id: 7, nome: 'Coxa de Frango', categoria: 'frango', proteina: 27, carbs: 0, gordura: 8, calorias: 185, custo: 1.2, porcao: '100g' },
            { id: 8, nome: 'Sobrecoxa de Frango', categoria: 'frango', proteina: 26, carbs: 0, gordura: 10, calorias: 198, custo: 1.0, porcao: '100g' },
            { id: 9, nome: 'Frango Desfiado', categoria: 'frango', proteina: 30, carbs: 0, gordura: 4, calorias: 160, custo: 1.8, porcao: '100g' },
            { id: 10, nome: 'TilÃ¡pia', categoria: 'peixe', proteina: 26, carbs: 0, gordura: 3, calorias: 129, custo: 5.0, porcao: '100g' },
            { id: 11, nome: 'Atum Enlatado', categoria: 'peixe', proteina: 24, carbs: 0, gordura: 1, calorias: 105, custo: 6.5, porcao: '100g' },
            { id: 12, nome: 'SalmÃ£o', categoria: 'peixe', proteina: 25, carbs: 0, gordura: 13, calorias: 231, custo: 12.0, porcao: '100g' },
            { id: 13, nome: 'Sardinha', categoria: 'peixe', proteina: 22, carbs: 0, gordura: 11, calorias: 195, custo: 3.5, porcao: '100g' },
            { id: 14, nome: 'Merluza', categoria: 'peixe', proteina: 18, carbs: 0, gordura: 1, calorias: 79, custo: 4.0, porcao: '100g' },
            { id: 15, nome: 'Queijo Cottage', categoria: 'laticinio', proteina: 12, carbs: 3, gordura: 4, calorias: 98, custo: 3.5, porcao: '100g' },
            { id: 16, nome: 'Iogurte Grego Natural', categoria: 'laticinio', proteina: 10, carbs: 4, gordura: 5, calorias: 97, custo: 4.0, porcao: '100g' },
            { id: 17, nome: 'Leite Desnatado', categoria: 'laticinio', proteina: 3.5, carbs: 5, gordura: 0.1, calorias: 35, custo: 0.4, porcao: '100ml' },
            { id: 18, nome: 'Queijo Minas Frescal', categoria: 'laticinio', proteina: 17, carbs: 3, gordura: 19, calorias: 250, custo: 3.0, porcao: '100g' },
            { id: 19, nome: 'Ricota', categoria: 'laticinio', proteina: 11, carbs: 3, gordura: 8, calorias: 138, custo: 2.5, porcao: '100g' },
            { id: 20, nome: 'Ovo Inteiro Cozido', categoria: 'outros', proteina: 13, carbs: 1, gordura: 11, calorias: 155, custo: 0.6, porcao: '100g (2 ovos)' },
            { id: 21, nome: 'Clara de Ovo', categoria: 'outros', proteina: 11, carbs: 1, gordura: 0.2, calorias: 52, custo: 0.4, porcao: '100g (3 claras)' },
            { id: 22, nome: 'Ovo Mexido', categoria: 'outros', proteina: 12, carbs: 2, gordura: 12, calorias: 166, custo: 0.7, porcao: '100g' },
            { id: 23, nome: 'Lentilha Cozida', categoria: 'vegetal', proteina: 9, carbs: 20, gordura: 0.4, calorias: 116, custo: 1.2, porcao: '100g' },
            { id: 24, nome: 'GrÃ£o de Bico Cozido', categoria: 'vegetal', proteina: 9, carbs: 27, gordura: 3, calorias: 164, custo: 1.5, porcao: '100g' },
            { id: 25, nome: 'FeijÃ£o Preto Cozido', categoria: 'vegetal', proteina: 8, carbs: 23, gordura: 0.5, calorias: 132, custo: 0.8, porcao: '100g' },
            { id: 26, nome: 'Edamame', categoria: 'vegetal', proteina: 11, carbs: 8, gordura: 5, calorias: 122, custo: 3.0, porcao: '100g' },
            { id: 27, nome: 'Tofu Firme', categoria: 'vegetal', proteina: 8, carbs: 2, gordura: 4, calorias: 76, custo: 2.5, porcao: '100g' },
            { id: 28, nome: 'Whey Protein', categoria: 'suplemento', proteina: 24, carbs: 3, gordura: 1.5, calorias: 120, custo: 3.5, porcao: '30g (1 scoop)' },
            { id: 29, nome: 'Albumina', categoria: 'suplemento', proteina: 22, carbs: 2, gordura: 0, calorias: 96, custo: 2.0, porcao: '30g' },
            { id: 30, nome: 'CaseÃ­na', categoria: 'suplemento', proteina: 24, carbs: 3, gordura: 1, calorias: 117, custo: 4.0, porcao: '30g' },
            { id: 31, nome: 'Barra de ProteÃ­na', categoria: 'suplemento', proteina: 20, carbs: 25, gordura: 8, calorias: 252, custo: 8.0, porcao: '60g (1 unid)' },
            { id: 32, nome: 'Pasta de Amendoim', categoria: 'outros', proteina: 25, carbs: 20, gordura: 50, calorias: 588, custo: 2.5, porcao: '100g' },
            // === CARNES TÃPICAS DO CENTRO-OESTE ===
            { id: 33, nome: 'Cupim Bovino', categoria: 'carne', proteina: 28, carbs: 0, gordura: 18, calorias: 280, custo: 5.0, porcao: '100g' },
            { id: 34, nome: 'Costela Bovina', categoria: 'carne', proteina: 24, carbs: 0, gordura: 22, calorias: 300, custo: 4.0, porcao: '100g' },
            { id: 35, nome: 'Maminha', categoria: 'carne', proteina: 32, carbs: 0, gordura: 8, calorias: 204, custo: 6.5, porcao: '100g' },
            { id: 36, nome: 'Carne de Sol', categoria: 'carne', proteina: 40, carbs: 0, gordura: 5, calorias: 205, custo: 5.5, porcao: '100g' },
            { id: 37, nome: 'Carne Seca (JabÃ¡)', categoria: 'carne', proteina: 45, carbs: 0, gordura: 8, calorias: 252, custo: 6.0, porcao: '100g' },
            { id: 38, nome: 'LinguiÃ§a Cuiabana', categoria: 'carne', proteina: 18, carbs: 2, gordura: 25, calorias: 310, custo: 3.5, porcao: '100g' },
            { id: 39, nome: 'Fraldinha', categoria: 'carne', proteina: 30, carbs: 0, gordura: 10, calorias: 218, custo: 5.0, porcao: '100g' },
            { id: 40, nome: 'AcÃ©m Bovino', categoria: 'carne', proteina: 29, carbs: 0, gordura: 7, calorias: 183, custo: 3.5, porcao: '100g' },
            // === PEIXES DO PANTANAL E REGIÃƒO ===
            { id: 41, nome: 'Pintado', categoria: 'peixe', proteina: 24, carbs: 0, gordura: 4, calorias: 132, custo: 8.0, porcao: '100g' },
            { id: 42, nome: 'Pacu', categoria: 'peixe', proteina: 22, carbs: 0, gordura: 8, calorias: 160, custo: 6.0, porcao: '100g' },
            { id: 43, nome: 'Dourado', categoria: 'peixe', proteina: 23, carbs: 0, gordura: 5, calorias: 137, custo: 9.0, porcao: '100g' },
            { id: 44, nome: 'Cachara', categoria: 'peixe', proteina: 22, carbs: 0, gordura: 3, calorias: 115, custo: 7.5, porcao: '100g' },
            { id: 45, nome: 'Piraputanga', categoria: 'peixe', proteina: 21, carbs: 0, gordura: 6, calorias: 142, custo: 6.5, porcao: '100g' },
            { id: 46, nome: 'TucunarÃ©', categoria: 'peixe', proteina: 25, carbs: 0, gordura: 2, calorias: 118, custo: 8.5, porcao: '100g' },
            { id: 47, nome: 'Piau (Piau-TrÃªs-Pintas)', categoria: 'peixe', proteina: 20, carbs: 0, gordura: 5, calorias: 125, custo: 5.0, porcao: '100g' },
            { id: 48, nome: 'Tambaqui', categoria: 'peixe', proteina: 23, carbs: 0, gordura: 7, calorias: 155, custo: 6.0, porcao: '100g' },
            // === AVES REGIONAIS ===
            { id: 49, nome: 'Galinha Caipira', categoria: 'frango', proteina: 28, carbs: 0, gordura: 7, calorias: 179, custo: 2.5, porcao: '100g' },
            { id: 50, nome: 'Moela de Frango', categoria: 'frango', proteina: 27, carbs: 0, gordura: 5, calorias: 153, custo: 1.8, porcao: '100g' },
            { id: 51, nome: 'CoraÃ§Ã£o de Frango', categoria: 'frango', proteina: 26, carbs: 0, gordura: 8, calorias: 178, custo: 2.0, porcao: '100g' },
            { id: 52, nome: 'FÃ­gado de Frango', categoria: 'frango', proteina: 24, carbs: 1, gordura: 5, calorias: 145, custo: 1.5, porcao: '100g' },
            { id: 53, nome: 'Peru Assado', categoria: 'frango', proteina: 29, carbs: 0, gordura: 4, calorias: 154, custo: 4.0, porcao: '100g' },
            // === LATICÃNIOS REGIONAIS ===
            { id: 54, nome: 'Queijo Meia Cura', categoria: 'laticinio', proteina: 25, carbs: 2, gordura: 28, calorias: 362, custo: 4.5, porcao: '100g' },
            { id: 55, nome: 'RequeijÃ£o Cremoso', categoria: 'laticinio', proteina: 10, carbs: 2, gordura: 22, calorias: 250, custo: 2.0, porcao: '100g' },
            { id: 56, nome: 'Queijo Coalho', categoria: 'laticinio', proteina: 21, carbs: 2, gordura: 24, calorias: 310, custo: 3.5, porcao: '100g' },
            // === OUTROS PROTEICOS REGIONAIS ===
            { id: 57, nome: 'Charque', categoria: 'carne', proteina: 48, carbs: 0, gordura: 6, calorias: 246, custo: 7.0, porcao: '100g' },
            { id: 58, nome: 'MocotÃ³ (Carne)', categoria: 'carne', proteina: 22, carbs: 0, gordura: 4, calorias: 124, custo: 2.0, porcao: '100g' },
            { id: 59, nome: 'Rabada Bovina', categoria: 'carne', proteina: 26, carbs: 0, gordura: 15, calorias: 245, custo: 3.5, porcao: '100g' },
            { id: 60, nome: 'Buchada de Boi', categoria: 'carne', proteina: 18, carbs: 2, gordura: 8, calorias: 152, custo: 2.5, porcao: '100g' },
        ];

        const carbsDatabase = [
            { id: 1, nome: 'Arroz Branco Cozido', carbs: 28, proteina: 2.7, gordura: 0.3, calorias: 130, porcao: '100g' },
            { id: 2, nome: 'Arroz Integral Cozido', carbs: 23, proteina: 2.6, gordura: 0.9, calorias: 112, porcao: '100g' },
            { id: 3, nome: 'Batata Doce Cozida', carbs: 20, proteina: 0.6, gordura: 0.1, calorias: 86, porcao: '100g' },
            { id: 4, nome: 'Batata Inglesa Cozida', carbs: 17, proteina: 2, gordura: 0.1, calorias: 77, porcao: '100g' },
            { id: 5, nome: 'MacarrÃ£o Integral Cozido', carbs: 26, proteina: 5, gordura: 0.9, calorias: 131, porcao: '100g' },
            { id: 6, nome: 'Aveia em Flocos', carbs: 66, proteina: 14, gordura: 7, calorias: 389, porcao: '100g' },
            { id: 7, nome: 'PÃ£o Integral', carbs: 49, proteina: 9, gordura: 3.4, calorias: 265, porcao: '100g' },
            { id: 8, nome: 'Tapioca Hidratada', carbs: 88, proteina: 0.2, gordura: 0.02, calorias: 358, porcao: '100g' },
            { id: 9, nome: 'Mandioca Cozida', carbs: 30, proteina: 0.6, gordura: 0.3, calorias: 125, porcao: '100g' },
            { id: 10, nome: 'Banana', carbs: 23, proteina: 1.1, gordura: 0.3, calorias: 89, porcao: '100g' },
            { id: 11, nome: 'MaÃ§Ã£', carbs: 14, proteina: 0.3, gordura: 0.2, calorias: 52, porcao: '100g' },
            { id: 12, nome: 'Granola', carbs: 65, proteina: 10, gordura: 15, calorias: 450, porcao: '100g' },
        ];

        const fatsDatabase = [
            { id: 1, nome: 'Azeite Extra Virgem', gordura: 100, carbs: 0, proteina: 0, calorias: 884, porcao: '100ml' },
            { id: 2, nome: 'Abacate', gordura: 15, carbs: 9, proteina: 2, calorias: 160, porcao: '100g' },
            { id: 3, nome: 'Castanha do ParÃ¡', gordura: 67, carbs: 12, proteina: 14, calorias: 656, porcao: '100g' },
            { id: 4, nome: 'Amendoim Torrado', gordura: 49, carbs: 16, proteina: 26, calorias: 567, porcao: '100g' },
            { id: 5, nome: 'AmÃªndoas', gordura: 50, carbs: 22, proteina: 21, calorias: 579, porcao: '100g' },
            { id: 6, nome: 'Nozes', gordura: 65, carbs: 14, proteina: 15, calorias: 654, porcao: '100g' },
            { id: 7, nome: 'Chia', gordura: 31, carbs: 42, proteina: 17, calorias: 486, porcao: '100g' },
            { id: 8, nome: 'LinhaÃ§a', gordura: 42, carbs: 29, proteina: 18, calorias: 534, porcao: '100g' },
            { id: 9, nome: 'Coco Ralado', gordura: 65, carbs: 24, proteina: 6.9, calorias: 660, porcao: '100g' },
            { id: 10, nome: 'Manteiga de Amendoim Natural', gordura: 50, carbs: 20, proteina: 25, calorias: 588, porcao: '100g' },
        ];

        const mealSuggestions = {
            cafe: { carbs: ['Aveia em Flocos', 'PÃ£o Integral', 'Tapioca Hidratada', 'Banana', 'Granola'], fats: ['Manteiga de Amendoim Natural', 'Abacate', 'Castanha do ParÃ¡', 'AmÃªndoas', 'Chia'] },
            lancheManha: { carbs: ['Banana', 'MaÃ§Ã£', 'Aveia em Flocos', 'Granola'], fats: ['Castanha do ParÃ¡', 'AmÃªndoas', 'Nozes', 'Manteiga de Amendoim Natural'] },
            almoco: { carbs: ['Arroz Integral Cozido', 'Batata Doce Cozida', 'Batata Inglesa Cozida', 'MacarrÃ£o Integral Cozido'], fats: ['Azeite Extra Virgem', 'Abacate'] },
            lancheTarde: { carbs: ['Banana', 'MaÃ§Ã£', 'Batata Doce Cozida', 'Tapioca Hidratada'], fats: ['Amendoim Torrado', 'Castanha do ParÃ¡', 'Manteiga de Amendoim Natural'] },
            jantar: { carbs: ['Arroz Integral Cozido', 'Batata Doce Cozida', 'Mandioca Cozida', 'MacarrÃ£o Integral Cozido'], fats: ['Azeite Extra Virgem', 'Abacate', 'AmÃªndoas'] },
            ceia: { carbs: ['Aveia em Flocos', 'Banana'], fats: ['Manteiga de Amendoim Natural', 'AmÃªndoas', 'Nozes'] }
        };

        const recipesDatabase = [
            { id: 1, nome: 'Omelete Proteica', proteina: 35, carbs: 5, gordura: 18, calorias: 320, tempo: '10 min', ingredientes: ['4 claras de ovo', '2 ovos inteiros', '50g queijo cottage', 'Temperos a gosto'], preparo: '1. Bata os ovos com as claras. 2. Adicione o cottage. 3. Frite em frigideira antiaderente. 4. Tempere e sirva.' },
            { id: 2, nome: 'Frango com Batata Doce', proteina: 45, carbs: 35, gordura: 8, calorias: 400, tempo: '30 min', ingredientes: ['200g peito de frango', '150g batata doce', 'Azeite', 'Temperos'], preparo: '1. Tempere e grelhe o frango. 2. Asse a batata doce. 3. Sirva com legumes.' },
            { id: 3, nome: 'Panqueca Proteica', proteina: 30, carbs: 25, gordura: 10, calorias: 310, tempo: '15 min', ingredientes: ['2 ovos', '30g whey protein', '50g aveia', '100ml leite desnatado'], preparo: '1. Bata todos ingredientes no liquidificador. 2. Frite em frigideira antiaderente. 3. Sirva com frutas.' },
            { id: 4, nome: 'Iogurte Proteico com Frutas', proteina: 25, carbs: 30, gordura: 8, calorias: 290, tempo: '5 min', ingredientes: ['200g iogurte grego', '1 scoop whey', '100g frutas vermelhas', '20g granola'], preparo: '1. Misture o whey ao iogurte. 2. Adicione as frutas. 3. Finalize com granola.' },
            { id: 5, nome: 'Wrap de Frango', proteina: 40, carbs: 45, gordura: 12, calorias: 452, tempo: '20 min', ingredientes: ['150g frango desfiado', '1 tortilha integral', 'Alface, tomate', '30g queijo cottage'], preparo: '1. AqueÃ§a o frango. 2. Monte o wrap com todos ingredientes. 3. Enrole e sirva.' },
            { id: 6, nome: 'Smoothie Proteico', proteina: 35, carbs: 40, gordura: 6, calorias: 362, tempo: '5 min', ingredientes: ['1 scoop whey', '1 banana', '200ml leite desnatado', '1 col pasta amendoim', 'Gelo'], preparo: '1. Bata todos ingredientes no liquidificador. 2. Sirva gelado.' },
            { id: 7, nome: 'Salada de Atum', proteina: 32, carbs: 20, gordura: 10, calorias: 298, tempo: '10 min', ingredientes: ['1 lata atum', 'Mix de folhas', 'Tomate cereja', '50g grÃ£o de bico', 'Azeite e limÃ£o'], preparo: '1. Misture todos ingredientes. 2. Tempere com azeite e limÃ£o.' },
            { id: 8, nome: 'Omelete no Pote', proteina: 28, carbs: 8, gordura: 15, calorias: 282, tempo: '3 min', ingredientes: ['3 ovos', '30g queijo', 'Tomate', 'Temperos'], preparo: '1. Bata os ovos em um pote. 2. Adicione queijo e tomate. 3. Micro-ondas por 2-3 minutos.' },
            { id: 9, nome: 'Bowl Proteico', proteina: 38, carbs: 50, gordura: 14, calorias: 478, tempo: '25 min', ingredientes: ['150g frango grelhado', '100g arroz integral', '50g feijÃ£o', 'Legumes grelhados'], preparo: '1. Cozinhe o arroz e feijÃ£o. 2. Grelhe o frango. 3. Monte o bowl com legumes.' },
            { id: 10, nome: 'Tapioca Proteica', proteina: 30, carbs: 35, gordura: 8, calorias: 332, tempo: '10 min', ingredientes: ['50g tapioca', '2 ovos', '50g queijo cottage', 'Peito de peru'], preparo: '1. Hidrate a tapioca. 2. FaÃ§a a tapioca na frigideira. 3. Recheie com ovo mexido, cottage e peru.' }
        ];

        // === CONQUISTAS ===
        const achievementsData = [
            { id: 1, icon: 'ðŸŽ¯', name: 'Primeiro Passo', desc: 'Calcule seus macros', condition: () => userMacros !== null },
            { id: 2, icon: 'â­', name: 'Colecionador', desc: 'Adicione 5 favoritos', condition: () => favorites.length >= 5 },
            { id: 3, icon: 'ðŸ“…', name: 'Planejador', desc: 'Crie seu primeiro plano', condition: () => history.length >= 1 },
            { id: 4, icon: 'ðŸ”¥', name: 'Em Chamas', desc: '3 dias de streak', condition: () => getStreak() >= 3 },
            { id: 5, icon: 'ðŸ’ª', name: 'ConsistÃªncia', desc: '7 dias de streak', condition: () => getStreak() >= 7 },
            { id: 6, icon: 'ðŸ†', name: 'CampeÃ£o', desc: '30 dias de streak', condition: () => getStreak() >= 30 },
            { id: 7, icon: 'ðŸ“Š', name: 'Analista', desc: 'Compare 3 alimentos', condition: () => localStorage.getItem('hasCompared') === 'true' },
            { id: 8, icon: 'ðŸ‘¨â€ðŸ³', name: 'Chef', desc: 'Veja 5 receitas', condition: () => parseInt(localStorage.getItem('recipesViewed') || '0') >= 5 },
            { id: 9, icon: 'ðŸ›’', name: 'Organizado', desc: 'Gere lista de compras', condition: () => localStorage.getItem('hasShoppingList') === 'true' },
            { id: 10, icon: 'ðŸŒŸ', name: 'Lenda', desc: 'Desbloqueie todas', condition: () => false }
        ];

        // === MENSAGENS DO AI COACH ===
        const aiMessages = {
            welcome: [
                'OlÃ¡! Sou o <strong>Max</strong>, seu coach de nutriÃ§Ã£o. Para personalizar suas recomendaÃ§Ãµes, preencha seus dados na <strong>Calculadora</strong>. Vamos juntos alcanÃ§ar seus objetivos! ðŸ’ª',
                'Bem-vindo ao ProteÃ­naMax PRO! Para comeÃ§ar sua jornada, precisamos conhecer seu perfil. VÃ¡ atÃ© a <strong>Calculadora</strong> e preencha seus dados! ðŸŽ¯'
            ],
            configured: [
                'Excelente! Com <strong>{protein}g de proteÃ­na</strong> por dia, vocÃª estÃ¡ no caminho certo para {goal}. Mantenha a consistÃªncia! ðŸ’ª',
                'Seus macros estÃ£o configurados! Foque em atingir <strong>{protein}g de proteÃ­na</strong> diariamente. Use o <strong>Planejador</strong> para organizar suas refeiÃ§Ãµes! ðŸ½ï¸',
                'Perfeito! Meta de <strong>{calories} kcal</strong> definida. Lembre-se: a consistÃªncia Ã© mais importante que a perfeiÃ§Ã£o! ðŸ†'
            ],
            streak: [
                'IncrÃ­vel! <strong>{days} dias</strong> de streak! VocÃª estÃ¡ construindo hÃ¡bitos sÃ³lidos! ðŸ”¥',
                'Wow! <strong>{days} dias</strong> consecutivos! Sua dedicaÃ§Ã£o Ã© inspiradora! Continue assim! âš¡'
            ],
            motivation: [
                'Cada refeiÃ§Ã£o Ã© uma oportunidade de se aproximar do seu objetivo. FaÃ§a valer a pena! ðŸŽ¯',
                'Lembre-se: mÃºsculos sÃ£o construÃ­dos na cozinha e esculpidos na academia. VocÃª estÃ¡ fazendo sua parte! ðŸ’ª',
                'A proteÃ­na Ã© o tijolo da construÃ§Ã£o muscular. NÃ£o deixe faltar! ðŸ§±'
            ]
        };

        // === ESTADO DA APLICAÃ‡ÃƒO ===
        let currentTheme = localStorage.getItem('theme') || 'dark';
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let history = JSON.parse(localStorage.getItem('history')) || [];
        let userMacros = JSON.parse(localStorage.getItem('userMacros')) || null;
        let currentSortField = 'nome';
        let currentSortOrder = 'asc';
        let currentCategory = '';
        let shoppingList = JSON.parse(localStorage.getItem('shoppingList')) || [];

        // === INICIALIZAÃ‡ÃƒO ===
        document.addEventListener('DOMContentLoaded', function() {
            document.documentElement.setAttribute('data-theme', currentTheme);
            document.getElementById('theme-icon').textContent = currentTheme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';

            updateStreak();
            renderFoodsTable();
            renderFavorites();
            renderRecipes();
            renderHistory();
            renderAchievements();
            populateCompareSelects();
            initMealPlanner();
            updateDashboard();
            updateAICoach();
            updateHeroSection();
            updateXP();

            // Restaurar dados do usuÃ¡rio se existirem
            if (userMacros) {
                document.getElementById('calc-weight').value = userMacros.weight || '';
            }
        });

        // === SISTEMA DE STREAK ===
        function getStreak() {
            const lastVisit = localStorage.getItem('lastVisit');
            const streak = parseInt(localStorage.getItem('streak') || '0');
            return streak;
        }

        function updateStreak() {
            const today = new Date().toDateString();
            const lastVisit = localStorage.getItem('lastVisit');
            let streak = parseInt(localStorage.getItem('streak') || '0');

            if (lastVisit !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);

                if (lastVisit === yesterday.toDateString()) {
                    streak++;
                    addXP(10); // XP por dia consecutivo
                    showToast('success', 'ðŸ”¥ Streak!', `${streak} dias consecutivos!`);
                } else if (lastVisit && lastVisit !== today) {
                    streak = 1;
                } else if (!lastVisit) {
                    streak = 1;
                }

                localStorage.setItem('lastVisit', today);
                localStorage.setItem('streak', streak.toString());
            }

            document.getElementById('streak-count').textContent = streak;
        }

        // === SISTEMA DE XP ===
        function getXP() {
            return parseInt(localStorage.getItem('xp') || '0');
        }

        function addXP(amount) {
            const currentXP = getXP();
            const newXP = currentXP + amount;
            localStorage.setItem('xp', newXP.toString());
            updateXP();
        }

        function updateXP() {
            document.getElementById('xp-count').textContent = getXP();
        }

        // === NAVEGAÃ‡ÃƒO ===
        function switchTab(tabName) {
            document.querySelectorAll('.nav-tab-pro').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.bottom-nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.tab-content-pro').forEach(content => content.classList.remove('active'));

            document.querySelectorAll(`[data-tab="${tabName}"]`).forEach(el => el.classList.add('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', currentTheme);
            document.getElementById('theme-icon').textContent = currentTheme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', currentTheme);
        }

        // === TOAST NOTIFICATIONS ===
        function showToast(type, title, message) {
            const container = document.getElementById('toast-container');
            const icons = { success: 'âœ…', error: 'âŒ', warning: 'âš ï¸' };

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;

            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // === AI COACH ===
        function updateAICoach() {
            const messageEl = document.getElementById('ai-message');
            let message;

            if (!userMacros) {
                message = aiMessages.welcome[Math.floor(Math.random() * aiMessages.welcome.length)];
            } else {
                const streak = getStreak();
                if (streak >= 3 && Math.random() > 0.5) {
                    message = aiMessages.streak[Math.floor(Math.random() * aiMessages.streak.length)]
                        .replace('{days}', streak);
                } else {
                    const goalText = { cutting: 'perder gordura', maintenance: 'manter seu peso', bulking: 'ganhar massa' };
                    message = aiMessages.configured[Math.floor(Math.random() * aiMessages.configured.length)]
                        .replace('{protein}', userMacros.protein)
                        .replace('{calories}', userMacros.calories)
                        .replace('{goal}', goalText[userMacros.goal] || 'seus objetivos');
                }
            }

            messageEl.innerHTML = message;
        }

        // === HERO SECTION ===
        function updateHeroSection() {
            if (userMacros) {
                document.getElementById('hero-protein').textContent = userMacros.protein + 'g';
                document.getElementById('hero-calories').textContent = userMacros.calories;
                document.getElementById('hero-message').textContent = 'VocÃª estÃ¡ no caminho certo! Continue seguindo seu plano.';
            }
        }

        // === CALCULADORA DE MACROS ===
        function calculateMacros() {
            const weight = parseFloat(document.getElementById('calc-weight').value);
            const height = parseFloat(document.getElementById('calc-height').value);
            const age = parseFloat(document.getElementById('calc-age').value);
            const gender = document.getElementById('calc-gender').value;
            const activity = parseFloat(document.getElementById('calc-activity').value);
            const goal = document.getElementById('calc-goal').value;

            if (!weight || !height || !age) {
                showToast('error', 'Campos obrigatÃ³rios', 'Preencha peso, altura e idade.');
                return;
            }

            let tmb = gender === 'male'
                ? (10 * weight) + (6.25 * height) - (5 * age) + 5
                : (10 * weight) + (6.25 * height) - (5 * age) - 161;

            const tdee = tmb * activity;

            let targetCalories, proteinMultiplier, carbsPercent, fatPercent;
            switch(goal) {
                case 'cutting': targetCalories = tdee - 500; proteinMultiplier = 2.2; carbsPercent = 35; fatPercent = 25; break;
                case 'bulking': targetCalories = tdee + 300; proteinMultiplier = 2.0; carbsPercent = 45; fatPercent = 25; break;
                default: targetCalories = tdee; proteinMultiplier = 2.0; carbsPercent = 40; fatPercent = 30;
            }

            const protein = Math.round(weight * proteinMultiplier);
            const proteinCal = protein * 4;
            const fat = Math.round((targetCalories * (fatPercent / 100)) / 9);
            const fatCal = fat * 9;
            const carbs = Math.round((targetCalories - proteinCal - fatCal) / 4);
            const carbsCal = carbs * 4;

            userMacros = {
                tmb: Math.round(tmb), tdee: Math.round(tdee), calories: Math.round(targetCalories),
                protein, carbs, fat, weight, goal
            };
            localStorage.setItem('userMacros', JSON.stringify(userMacros));

            document.getElementById('result-tmb').textContent = userMacros.tmb;
            document.getElementById('result-tdee').textContent = userMacros.tdee;
            document.getElementById('result-calories').textContent = userMacros.calories;
            document.getElementById('result-protein').textContent = protein;
            document.getElementById('result-protein-cal').textContent = proteinCal;
            document.getElementById('result-carbs').textContent = carbs;
            document.getElementById('result-carbs-cal').textContent = carbsCal;
            document.getElementById('result-fat').textContent = fat;
            document.getElementById('result-fat-cal').textContent = fatCal;
            document.getElementById('macro-results').style.display = 'block';

            updateDashboard();
            updateAICoach();
            updateHeroSection();
            checkAchievements();
            addXP(50);
            showToast('success', 'Macros calculados!', `Meta: ${protein}g proteÃ­na/dia`);
            document.getElementById('macro-results').scrollIntoView({ behavior: 'smooth' });
        }

        // === DASHBOARD ===
        function updateDashboard() {
            if (userMacros) {
                document.getElementById('dash-protein').textContent = userMacros.protein;
                document.getElementById('dash-carbs').textContent = userMacros.carbs;
                document.getElementById('dash-fat').textContent = userMacros.fat;
                document.getElementById('dash-calories').textContent = userMacros.calories;
            }
        }

        // === CONQUISTAS ===
        function renderAchievements() {
            const grid = document.getElementById('achievements-grid');
            let unlockedCount = 0;

            grid.innerHTML = achievementsData.map(a => {
                const unlocked = a.condition();
                if (unlocked) unlockedCount++;
                return `
                    <div class="achievement-card ${unlocked ? 'unlocked' : 'locked'}">
                        <div class="achievement-icon">${a.icon}</div>
                        <div class="achievement-name">${a.name}</div>
                        <div class="achievement-desc">${a.desc}</div>
                    </div>
                `;
            }).join('');

            document.getElementById('achievements-count').textContent = unlockedCount;
        }

        function checkAchievements() {
            renderAchievements();
        }

        // === TABELA DE ALIMENTOS ===
        function renderFoodsTable() {
            const tbody = document.getElementById('foods-tbody');
            let filteredFoods = [...foodsDatabase];

            if (currentCategory) filteredFoods = filteredFoods.filter(f => f.categoria === currentCategory);

            const searchTerm = document.getElementById('food-search')?.value.toLowerCase() || '';
            if (searchTerm) filteredFoods = filteredFoods.filter(f => f.nome.toLowerCase().includes(searchTerm) || f.categoria.toLowerCase().includes(searchTerm));

            filteredFoods.sort((a, b) => {
                const aVal = a[currentSortField], bVal = b[currentSortField];
                if (typeof aVal === 'string') return currentSortOrder === 'asc' ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
                return currentSortOrder === 'asc' ? aVal - bVal : bVal - aVal;
            });

            tbody.innerHTML = filteredFoods.map(food => {
                const isFav = favorites.includes(food.id);
                return `
                    <tr>
                        <td><strong>${food.nome}</strong><br><span class="badge-pro badge-${food.categoria}">${food.categoria}</span></td>
                        <td><strong style="color: var(--primary);">${food.proteina}g</strong></td>
                        <td>${food.carbs}g</td>
                        <td>${food.gordura}g</td>
                        <td>${food.calorias}</td>
                        <td style="color: var(--accent);">R$ ${food.custo.toFixed(2)}</td>
                        <td><button class="fav-btn ${isFav ? 'active' : ''}" onclick="toggleFavorite(${food.id})">${isFav ? 'â­' : 'â˜†'}</button></td>
                    </tr>
                `;
            }).join('');

            if (!filteredFoods.length) tbody.innerHTML = '<tr><td colspan="7" class="empty-state-pro">Nenhum alimento encontrado</td></tr>';
        }

        function sortTable(field) {
            currentSortOrder = currentSortField === field && currentSortOrder === 'asc' ? 'desc' : 'asc';
            currentSortField = field;
            renderFoodsTable();
        }

        function filterFoods() { renderFoodsTable(); }

        function filterByCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            renderFoodsTable();
        }

        // === FAVORITOS ===
        function toggleFavorite(foodId) {
            const idx = favorites.indexOf(foodId);
            idx > -1 ? favorites.splice(idx, 1) : favorites.push(foodId);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            renderFoodsTable();
            renderFavorites();
            checkAchievements();
            if (idx === -1) addXP(5);
        }

        function renderFavorites() {
            const container = document.getElementById('favorites-list');
            if (!favorites.length) {
                container.innerHTML = '<div class="empty-state-pro"><div class="icon">â­</div><h3>Nenhum favorito</h3><p>Adicione alimentos favoritos na aba Alimentos</p></div>';
                return;
            }
            container.innerHTML = favorites.map(id => {
                const food = foodsDatabase.find(f => f.id === id);
                return food ? `
                    <div class="shopping-item">
                        <div style="flex: 1;"><strong>${food.nome}</strong><div style="font-size: 13px; color: var(--text-secondary);">${food.proteina}g prot | ${food.calorias} kcal</div></div>
                        <button class="btn-pro btn-outline-pro" style="padding: 6px 12px;" onclick="toggleFavorite(${food.id})">âŒ</button>
                    </div>
                ` : '';
            }).join('');
        }

        // === COMPARADOR ===
        function populateCompareSelects() {
            ['compare-food-1', 'compare-food-2', 'compare-food-3'].forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    select.innerHTML = '<option value="">Selecione...</option>' + foodsDatabase.map(f => `<option value="${f.id}">${f.nome}</option>`).join('');
                }
            });
        }

        function compareFoods() {
            const ids = [1, 2, 3].map(i => parseInt(document.getElementById(`compare-food-${i}`).value)).filter(Boolean);
            const foods = ids.map(id => foodsDatabase.find(f => f.id === id)).filter(Boolean);

            if (foods.length < 2) { showToast('warning', 'SeleÃ§Ã£o incompleta', 'Selecione pelo menos 2 alimentos.'); return; }

            localStorage.setItem('hasCompared', 'true');
            checkAchievements();

            const bestProt = foods.reduce((a, b) => a.proteina > b.proteina ? a : b);
            const bestCost = foods.reduce((a, b) => (a.custo / a.proteina) < (b.custo / b.proteina) ? a : b);

            document.getElementById('compare-results').innerHTML = `
                <div class="compare-grid-pro">
                    ${foods.map(f => `
                        <div class="compare-card-pro ${f.id === bestProt.id && f.id === bestCost.id ? 'winner' : ''}">
                            ${f.id === bestProt.id && f.id === bestCost.id ? '<div class="trophy">ðŸ†</div>' : ''}
                            <h4>${f.nome}</h4>
                            <div class="compare-stat ${f.id === bestProt.id ? 'highlight' : ''}"><span>ProteÃ­na</span><strong>${f.proteina}g ${f.id === bestProt.id ? 'ðŸ‘‘' : ''}</strong></div>
                            <div class="compare-stat"><span>Carboidratos</span><strong>${f.carbs}g</strong></div>
                            <div class="compare-stat"><span>Gorduras</span><strong>${f.gordura}g</strong></div>
                            <div class="compare-stat"><span>Calorias</span><strong>${f.calorias}</strong></div>
                            <div class="compare-stat ${f.id === bestCost.id ? 'highlight' : ''}"><span>R$/g prot</span><strong>R$ ${(f.custo / f.proteina).toFixed(3)} ${f.id === bestCost.id ? 'ðŸ‘‘' : ''}</strong></div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // === RECEITAS ===
        function renderRecipes() {
            document.getElementById('recipes-list').innerHTML = recipesDatabase.map(r => `
                <div class="recipe-card-pro" onclick="toggleRecipeDetails(${r.id})">
                    <div class="recipe-header-pro"><h3>${r.nome}</h3><span class="recipe-time">â±ï¸ ${r.tempo}</span></div>
                    <div class="recipe-body-pro">
                        <div class="recipe-macros-pro">
                            <div class="recipe-macro"><div class="recipe-macro-value" style="color: var(--primary);">${r.proteina}g</div><div class="recipe-macro-label">Prot</div></div>
                            <div class="recipe-macro"><div class="recipe-macro-value" style="color: var(--accent);">${r.carbs}g</div><div class="recipe-macro-label">Carb</div></div>
                            <div class="recipe-macro"><div class="recipe-macro-value" style="color: var(--danger);">${r.gordura}g</div><div class="recipe-macro-label">Gord</div></div>
                            <div class="recipe-macro"><div class="recipe-macro-value">${r.calorias}</div><div class="recipe-macro-label">Kcal</div></div>
                        </div>
                        <div class="recipe-details" id="recipe-details-${r.id}">
                            <h4>ðŸ›’ Ingredientes:</h4><ul>${r.ingredientes.map(i => `<li>${i}</li>`).join('')}</ul>
                            <h4 style="margin-top: var(--space-md);">ðŸ‘¨â€ðŸ³ Preparo:</h4><p style="color: var(--text-secondary);">${r.preparo}</p>
                        </div>
                        <button class="btn-pro btn-outline-pro btn-full" style="margin-top: var(--space-md);">Ver detalhes</button>
                    </div>
                </div>
            `).join('');
        }

        function toggleRecipeDetails(id) {
            const details = document.getElementById(`recipe-details-${id}`);
            details.classList.toggle('show');
            const viewed = parseInt(localStorage.getItem('recipesViewed') || '0') + 1;
            localStorage.setItem('recipesViewed', viewed.toString());
            checkAchievements();
        }

        // === PLANEJADOR ===
        function initMealPlanner() {
            const meals = [
                { key: 'cafe', label: 'â˜• CafÃ© da ManhÃ£', weight: 0.20 },
                { key: 'lancheManha', label: 'ðŸŽ Lanche da ManhÃ£', weight: 0.10 },
                { key: 'almoco', label: 'ðŸ½ï¸ AlmoÃ§o', weight: 0.30 },
                { key: 'lancheTarde', label: 'ðŸ¥ª Lanche da Tarde', weight: 0.10 },
                { key: 'jantar', label: 'ðŸ² Jantar', weight: 0.25 },
                { key: 'ceia', label: 'ðŸŒ™ Ceia', weight: 0.05 }
            ];

            const proteinOptions = foodsDatabase.filter(f => f.proteina >= 8).map(f => `<option value="${f.id}">${f.nome} (${f.proteina}g)</option>`).join('');

            document.getElementById('meal-planner-container').innerHTML = meals.map(m => `
                <div class="meal-card">
                    <div class="meal-card-header">
                        <div class="meal-title"><span class="emoji">${m.label.split(' ')[0]}</span>${m.label.substring(2)}</div>
                        <span class="meal-weight-badge">${(m.weight * 100)}% proteÃ­na</span>
                    </div>
                    <div class="meal-card-body">
                        <div class="form-group-pro" style="margin-bottom: var(--space-sm);">
                            <label class="form-label-pro">ProteÃ­na principal</label>
                            <select class="form-select-pro protein-select" data-meal="${m.key}"><option value="">-- Selecione --</option>${proteinOptions}</select>
                        </div>
                        <div class="form-group-pro" style="margin-bottom: 0;">
                            <label class="form-label-pro">ProteÃ­na secundÃ¡ria (opcional)</label>
                            <select class="form-select-pro protein-select" data-meal="${m.key}"><option value="">-- Selecione --</option>${proteinOptions}</select>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function formatQuantity(name, grams) {
            const config = foodUnits[name];
            if (!config) return `${grams.toFixed(0)}g`;
            const units = Math.min(grams / config.gramsPerUnit, config.maxUnits);
            const finalGrams = units * config.gramsPerUnit;
            if (config.unit === 'scoop') return `${Math.round(units)} scoop${units > 1 ? 's' : ''} (${finalGrams.toFixed(0)}g)`;
            if (config.unit === 'unidade') return `${Math.round(units)} ${config.displayName}${units > 1 ? 's' : ''}`;
            if (config.unit === 'colher') return `${(Math.round(units * 2) / 2)} ${config.displayName}`;
            return `${finalGrams.toFixed(0)}g`;
        }

        function calculateRealGrams(name, targetGrams) {
            const config = foodUnits[name];
            if (!config) return targetGrams;
            return Math.min(targetGrams / config.gramsPerUnit, config.maxUnits) * config.gramsPerUnit;
        }

        function calculateSmartMealPlan() {
            if (!userMacros) { showToast('warning', 'Configure seus macros', 'VÃ¡ atÃ© a Calculadora primeiro.'); switchTab('calculator'); return; }

            const meals = [
                { key: 'cafe', label: 'â˜• CafÃ© da ManhÃ£', weight: 0.20 },
                { key: 'lancheManha', label: 'ðŸŽ Lanche da ManhÃ£', weight: 0.10 },
                { key: 'almoco', label: 'ðŸ½ï¸ AlmoÃ§o', weight: 0.30 },
                { key: 'lancheTarde', label: 'ðŸ¥ª Lanche da Tarde', weight: 0.10 },
                { key: 'jantar', label: 'ðŸ² Jantar', weight: 0.25 },
                { key: 'ceia', label: 'ðŸŒ™ Ceia', weight: 0.05 }
            ];

            const selectedProteins = {};
            document.querySelectorAll('.protein-select').forEach(sel => {
                if (sel.value) {
                    const meal = sel.dataset.meal;
                    if (!selectedProteins[meal]) selectedProteins[meal] = [];
                    selectedProteins[meal].push(parseInt(sel.value));
                }
            });

            if (!Object.keys(selectedProteins).length) { showToast('warning', 'SeleÃ§Ã£o vazia', 'Selecione pelo menos uma proteÃ­na.'); return; }

            let totalProt = 0, totalCarbs = 0, totalFat = 0, totalCal = 0, totalCost = 0;
            const detailedMeals = [];

            let planHTML = '<h3 style="margin-bottom: var(--space-lg); color: var(--primary);">ðŸ½ï¸ Seu Plano Inteligente</h3>';

            meals.forEach(meal => {
                const protIds = selectedProteins[meal.key];
                if (!protIds?.length) return;

                const mealProtTarget = userMacros.protein * meal.weight;
                const mealCarbsTarget = userMacros.carbs * meal.weight;
                const mealFatTarget = userMacros.fat * meal.weight;
                const protPerSource = mealProtTarget / protIds.length;

                const proteinItems = [];
                let actualProt = 0, actualCarbs = 0, actualFat = 0, actualCal = 0, actualCost = 0;

                protIds.forEach(id => {
                    const prot = foodsDatabase.find(f => f.id === id);
                    if (!prot) return;
                    let grams = (protPerSource / prot.proteina) * 100;
                    grams = calculateRealGrams(prot.nome, grams);
                    const p = (grams / 100) * prot.proteina;
                    const c = (grams / 100) * prot.carbs;
                    const g = (grams / 100) * prot.gordura;
                    const cal = (grams / 100) * prot.calorias;
                    const cost = (grams / 100) * prot.custo;
                    actualProt += p; actualCarbs += c; actualFat += g; actualCal += cal; actualCost += cost;
                    proteinItems.push({ protein: prot, grams, p, c, g });
                });

                const suggestions = mealSuggestions[meal.key] || mealSuggestions.almoco;
                const carbName = suggestions.carbs[Math.floor(Math.random() * suggestions.carbs.length)];
                const fatName = suggestions.fats[Math.floor(Math.random() * suggestions.fats.length)];
                const carbFood = carbsDatabase.find(c => c.nome === carbName);
                const fatFood = fatsDatabase.find(f => f.nome === fatName);

                let carbGrams = 0, fatGrams = 0, carbMacros = 0, fatMacros = 0;
                if (carbFood && mealCarbsTarget - actualCarbs > 5) {
                    carbGrams = ((mealCarbsTarget - actualCarbs) / carbFood.carbs) * 100;
                    carbMacros = (carbGrams / 100) * carbFood.carbs;
                    actualCarbs += carbMacros;
                    actualCal += (carbGrams / 100) * carbFood.calorias;
                }
                if (fatFood && mealFatTarget - actualFat > 2) {
                    fatGrams = ((mealFatTarget - actualFat) / fatFood.gordura) * 100;
                    fatMacros = (fatGrams / 100) * fatFood.gordura;
                    actualFat += fatMacros;
                    actualCal += (fatGrams / 100) * fatFood.calorias;
                }

                totalProt += actualProt; totalCarbs += actualCarbs; totalFat += actualFat; totalCal += actualCal; totalCost += actualCost;

                planHTML += `<div class="card-pro" style="margin-bottom: var(--space-md);">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-md);">
                        <h4 style="color: var(--primary);">${meal.label}</h4>
                        <span style="color: var(--text-secondary);">${actualCal.toFixed(0)} kcal</span>
                    </div>`;

                proteinItems.forEach(item => {
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--primary);">
                        <div style="display: flex; justify-content: space-between;"><strong style="color: var(--primary);">ðŸ¥© ${item.protein.nome}</strong><span>${formatQuantity(item.protein.nome, item.grams)}</span></div>
                        <div style="font-size: 12px; color: var(--text-muted);">${item.p.toFixed(1)}g prot | ${item.c.toFixed(1)}g carb | ${item.g.toFixed(1)}g gord</div>
                    </div>`;
                });

                if (carbFood && carbGrams > 0) {
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--accent);">
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--accent);">ðŸš ${carbFood.nome}</span><span>${carbGrams.toFixed(0)}g</span></div>
                        <div style="font-size: 12px; color: var(--text-muted);">${carbMacros.toFixed(1)}g carb</div>
                    </div>`;
                }

                if (fatFood && fatGrams > 0) {
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--danger);">
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--danger);">ðŸ¥‘ ${fatFood.nome}</span><span>${fatGrams.toFixed(0)}g</span></div>
                        <div style="font-size: 12px; color: var(--text-muted);">${fatMacros.toFixed(1)}g gord</div>
                    </div>`;
                }

                planHTML += `<div style="font-size: 12px; color: var(--text-secondary); border-top: 1px solid var(--border-default); padding-top: var(--space-sm); margin-top: var(--space-sm);">
                    <strong>Total:</strong> ${actualProt.toFixed(0)}g prot | ${actualCarbs.toFixed(0)}g carb | ${actualFat.toFixed(0)}g gord
                </div></div>`;

                detailedMeals.push({
                    key: meal.key, label: meal.label,
                    proteins: proteinItems.map(i => ({ id: i.protein.id, nome: i.protein.nome, quantidade: formatQuantity(i.protein.nome, i.grams), grams: i.grams, macros: { proteina: i.p.toFixed(1), carbs: i.c.toFixed(1), gordura: i.g.toFixed(1) } })),
                    carb: carbFood && carbGrams > 0 ? { nome: carbFood.nome, quantidade: carbGrams.toFixed(0) + 'g', macros: carbMacros.toFixed(1) + 'g carb' } : null,
                    fat: fatFood && fatGrams > 0 ? { nome: fatFood.nome, quantidade: fatGrams.toFixed(0) + 'g', macros: fatMacros.toFixed(1) + 'g gord' } : null,
                    totals: { proteina: actualProt.toFixed(0), carbs: actualCarbs.toFixed(0), gordura: actualFat.toFixed(0), calorias: actualCal.toFixed(0) }
                });
            });

            planHTML += `<div style="background: var(--gradient-primary); padding: var(--space-lg); border-radius: var(--radius-xl); color: white; margin-top: var(--space-lg);">
                <h4 style="margin-bottom: var(--space-md); color: white;">ðŸ“Š Resumo do Dia</h4>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--space-md); text-align: center;">
                    <div><div style="font-size: 28px; font-weight: 800;">${totalProt.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">ProteÃ­nas</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalCarbs.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">Carboidratos</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalFat.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">Gorduras</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalCal.toFixed(0)}</div><div style="font-size: 11px; opacity: 0.9;">Calorias</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">R$ ${totalCost.toFixed(2)}</div><div style="font-size: 11px; opacity: 0.9;">Custo</div></div>
                </div>
            </div>
            <button class="btn-pro btn-secondary-pro btn-full" style="margin-top: var(--space-lg);" onclick="savePlanToHistory()">ðŸ’¾ Salvar no HistÃ³rico</button>`;

            document.getElementById('plan-results').innerHTML = planHTML;
            document.getElementById('plan-results').style.display = 'block';
            document.getElementById('plan-results').scrollIntoView({ behavior: 'smooth' });

            window.currentPlan = { date: new Date().toISOString(), protein: totalProt.toFixed(0), carbs: totalCarbs.toFixed(0), fat: totalFat.toFixed(0), calories: totalCal.toFixed(0), cost: totalCost.toFixed(2), meals: detailedMeals };
            addXP(25);
        }

        // === PLANEJAMENTO AUTOMÃTICO INTELIGENTE ===
        function generateAutoPlan() {
            if (!userMacros) {
                showToast('warning', 'Configure seus macros', 'VÃ¡ atÃ© a Calculadora primeiro.');
                switchTab('calculator');
                return;
            }

            // Regras de contexto: quais alimentos sÃ£o apropriados para cada refeiÃ§Ã£o
            const mealContext = {
                cafe: {
                    allowed: ['suplemento', 'laticinio', 'outros'], // Whey, iogurte, ovos, cottage
                    forbidden: ['carne', 'peixe'], // NÃ£o faz sentido bife no cafÃ©
                    preferredNames: ['Whey Protein', 'Ovo Inteiro Cozido', 'Ovo Mexido', 'Clara de Ovo', 'Iogurte Grego Natural', 'Queijo Cottage', 'Queijo Minas Frescal', 'Queijo Coalho', 'RequeijÃ£o Cremoso']
                },
                lancheManha: {
                    allowed: ['suplemento', 'laticinio', 'outros'],
                    forbidden: ['carne', 'peixe', 'frango'],
                    preferredNames: ['Whey Protein', 'Iogurte Grego Natural', 'Queijo Cottage', 'Barra de ProteÃ­na', 'Pasta de Amendoim', 'Clara de Ovo', 'Queijo Coalho', 'Queijo Meia Cura']
                },
                almoco: {
                    allowed: ['carne', 'frango', 'peixe', 'vegetal', 'outros'],
                    forbidden: ['suplemento'], // NÃ£o tomar whey no almoÃ§o
                    preferredNames: ['Peito de Frango Grelhado', 'Patinho Bovino', 'Alcatra', 'TilÃ¡pia', 'SalmÃ£o', 'Frango Desfiado', 'FilÃ© Mignon', 'Contra-FilÃ©',
                        // Carnes Centro-Oeste
                        'Maminha', 'Fraldinha', 'Carne de Sol', 'AcÃ©m Bovino', 'Cupim Bovino',
                        // Peixes do Pantanal
                        'Pintado', 'Pacu', 'Dourado', 'Tambaqui', 'TucunarÃ©', 'Piraputanga',
                        // Aves regionais
                        'Galinha Caipira', 'Moela de Frango', 'CoraÃ§Ã£o de Frango']
                },
                lancheTarde: {
                    allowed: ['suplemento', 'laticinio', 'outros', 'vegetal'],
                    forbidden: ['carne', 'peixe'],
                    preferredNames: ['Whey Protein', 'Iogurte Grego Natural', 'Queijo Cottage', 'Ovo Inteiro Cozido', 'Pasta de Amendoim', 'Barra de ProteÃ­na', 'Queijo Coalho', 'RequeijÃ£o Cremoso']
                },
                jantar: {
                    allowed: ['carne', 'frango', 'peixe', 'vegetal', 'laticinio', 'outros'],
                    forbidden: ['suplemento'],
                    preferredNames: ['Peito de Frango Grelhado', 'TilÃ¡pia', 'SalmÃ£o', 'Patinho Bovino', 'Alcatra', 'Ovo Inteiro Cozido', 'Sardinha', 'Merluza',
                        // Carnes Centro-Oeste
                        'Maminha', 'Fraldinha', 'Carne de Sol', 'Rabada Bovina', 'Costela Bovina',
                        // Peixes do Pantanal
                        'Pintado', 'Pacu', 'Dourado', 'Cachara', 'Piau (Piau-TrÃªs-Pintas)',
                        // Aves regionais
                        'Galinha Caipira', 'Peru Assado']
                },
                ceia: {
                    allowed: ['suplemento', 'laticinio', 'outros'],
                    forbidden: ['carne', 'frango', 'peixe'], // DigestÃ£o lenta antes de dormir
                    preferredNames: ['CaseÃ­na', 'Queijo Cottage', 'Iogurte Grego Natural', 'Clara de Ovo', 'Ricota', 'Queijo Meia Cura', 'RequeijÃ£o Cremoso']
                }
            };

            // Limites realistas por tipo de alimento (mÃ¡ximo por refeiÃ§Ã£o)
            const realisticLimits = {
                'Ovo Inteiro Cozido': { maxGrams: 150, maxUnits: 3, unit: 'ovos' },
                'Ovo Mexido': { maxGrams: 150, maxUnits: 3, unit: 'ovos' },
                'Clara de Ovo': { maxGrams: 200, maxUnits: 6, unit: 'claras' },
                'Whey Protein': { maxGrams: 60, maxUnits: 2, unit: 'scoops' },
                'Albumina': { maxGrams: 60, maxUnits: 2, unit: 'scoops' },
                'CaseÃ­na': { maxGrams: 60, maxUnits: 2, unit: 'scoops' },
                'Queijo Cottage': { maxGrams: 100, maxUnits: 4, unit: 'colheres' },
                'Pasta de Amendoim': { maxGrams: 30, maxUnits: 2, unit: 'colheres' },
                'Iogurte Grego Natural': { maxGrams: 200, maxUnits: 1, unit: 'pote' },
                'Barra de ProteÃ­na': { maxGrams: 60, maxUnits: 1, unit: 'unidade' },
                // Carnes Centro-Oeste (porÃ§Ãµes maiores para churrasco)
                'Cupim Bovino': { maxGrams: 180, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'Costela Bovina': { maxGrams: 200, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'LinguiÃ§a Cuiabana': { maxGrams: 100, maxUnits: 2, unit: 'unidades' },
                'Carne de Sol': { maxGrams: 150, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'Carne Seca (JabÃ¡)': { maxGrams: 100, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'Charque': { maxGrams: 80, maxUnits: 1, unit: 'porÃ§Ã£o' },
                // MiÃºdos de frango (porÃ§Ãµes menores)
                'Moela de Frango': { maxGrams: 150, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'CoraÃ§Ã£o de Frango': { maxGrams: 150, maxUnits: 1, unit: 'porÃ§Ã£o' },
                'FÃ­gado de Frango': { maxGrams: 100, maxUnits: 1, unit: 'porÃ§Ã£o' },
                // LaticÃ­nios regionais
                'RequeijÃ£o Cremoso': { maxGrams: 50, maxUnits: 2, unit: 'colheres' },
                'Queijo Coalho': { maxGrams: 80, maxUnits: 2, unit: 'fatias' },
                'Queijo Meia Cura': { maxGrams: 60, maxUnits: 2, unit: 'fatias' },
                // Peixes do Pantanal (porÃ§Ãµes generosas)
                'Pintado': { maxGrams: 200, maxUnits: 1, unit: 'filÃ©' },
                'Pacu': { maxGrams: 200, maxUnits: 1, unit: 'posta' },
                'Dourado': { maxGrams: 180, maxUnits: 1, unit: 'posta' },
                'Tambaqui': { maxGrams: 200, maxUnits: 1, unit: 'posta' },
                // Carnes/peixes: porÃ§Ãµes normais de 100-200g
                'default_meat': { maxGrams: 200 },
                'default_fish': { maxGrams: 180 }
            };

            const meals = [
                { key: 'cafe', label: 'â˜• CafÃ© da ManhÃ£', weight: 0.20 },
                { key: 'lancheManha', label: 'ðŸŽ Lanche da ManhÃ£', weight: 0.10 },
                { key: 'almoco', label: 'ðŸ½ï¸ AlmoÃ§o', weight: 0.30 },
                { key: 'lancheTarde', label: 'ðŸ¥ª Lanche da Tarde', weight: 0.10 },
                { key: 'jantar', label: 'ðŸ² Jantar', weight: 0.25 },
                { key: 'ceia', label: 'ðŸŒ™ Ceia', weight: 0.05 }
            ];

            // FunÃ§Ã£o para verificar se alimento Ã© apropriado para a refeiÃ§Ã£o
            function isFoodAppropriate(food, mealKey) {
                const context = mealContext[mealKey];
                if (context.forbidden.includes(food.categoria)) return false;
                if (context.allowed.includes(food.categoria)) return true;
                return false;
            }

            // FunÃ§Ã£o para obter alimentos disponÃ­veis para uma refeiÃ§Ã£o (prioriza favoritos)
            function getAvailableFoods(mealKey) {
                const context = mealContext[mealKey];

                // Primeiro: favoritos que sÃ£o apropriados para esta refeiÃ§Ã£o
                const favoriteFoods = favorites
                    .map(id => foodsDatabase.find(f => f.id === id))
                    .filter(f => f && isFoodAppropriate(f, mealKey) && f.proteina >= 8);

                // Se tem favoritos apropriados, usa eles
                if (favoriteFoods.length > 0) return favoriteFoods;

                // SenÃ£o: usa os alimentos preferidos para esta refeiÃ§Ã£o
                const preferredFoods = context.preferredNames
                    .map(name => foodsDatabase.find(f => f.nome === name))
                    .filter(f => f && f.proteina >= 8);

                return preferredFoods.length > 0 ? preferredFoods :
                    foodsDatabase.filter(f => isFoodAppropriate(f, mealKey) && f.proteina >= 8);
            }

            // FunÃ§Ã£o para calcular gramas com limite realista
            function getRealisticGrams(food, targetGrams) {
                const limit = realisticLimits[food.nome];
                if (limit) return Math.min(targetGrams, limit.maxGrams);

                // Limites padrÃ£o por categoria
                if (food.categoria === 'carne') return Math.min(targetGrams, 200);
                if (food.categoria === 'frango') return Math.min(targetGrams, 200);
                if (food.categoria === 'peixe') return Math.min(targetGrams, 180);
                if (food.categoria === 'suplemento') return Math.min(targetGrams, 60);

                return Math.min(targetGrams, 150); // Limite padrÃ£o
            }

            // Gerar plano
            let totalProt = 0, totalCarbs = 0, totalFat = 0, totalCal = 0, totalCost = 0;
            const detailedMeals = [];
            const usedFoodsToday = new Set(); // Evitar repetir o mesmo alimento em refeiÃ§Ãµes seguidas

            let planHTML = '<h3 style="margin-bottom: var(--space-lg); color: var(--gold);">âœ¨ Plano AutomÃ¡tico Gerado</h3>';

            if (favorites.length > 0) {
                planHTML += `<div style="background: var(--gold-light); padding: var(--space-sm) var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-lg); font-size: 13px; color: var(--text-secondary);">
                    <strong style="color: var(--gold);">â­ Usando seus ${favorites.length} favoritos</strong> como base do plano!
                </div>`;
            }

            meals.forEach((meal, mealIndex) => {
                const mealProtTarget = userMacros.protein * meal.weight;
                const mealCarbsTarget = userMacros.carbs * meal.weight;
                const mealFatTarget = userMacros.fat * meal.weight;

                // Obter alimentos disponÃ­veis para esta refeiÃ§Ã£o
                let availableFoods = getAvailableFoods(meal.key);

                // Tentar nÃ£o repetir alimentos usados nas Ãºltimas 2 refeiÃ§Ãµes
                const freshFoods = availableFoods.filter(f => !usedFoodsToday.has(f.id));
                if (freshFoods.length > 0) availableFoods = freshFoods;

                // Selecionar 1 ou 2 proteÃ­nas dependendo do tamanho da refeiÃ§Ã£o
                const numProteins = meal.weight >= 0.25 ? 2 : 1;
                const selectedProteins = [];

                for (let i = 0; i < Math.min(numProteins, availableFoods.length); i++) {
                    // Escolher aleatoriamente entre os disponÃ­veis para variedade
                    const randomIndex = Math.floor(Math.random() * availableFoods.length);
                    const protein = availableFoods[randomIndex];
                    selectedProteins.push(protein);
                    availableFoods = availableFoods.filter(f => f.id !== protein.id);
                    usedFoodsToday.add(protein.id);
                }

                // Limpar alimentos usados hÃ¡ mais de 3 refeiÃ§Ãµes
                if (mealIndex >= 3) {
                    usedFoodsToday.clear();
                }

                const protPerSource = mealProtTarget / selectedProteins.length;
                const proteinItems = [];
                let actualProt = 0, actualCarbs = 0, actualFat = 0, actualCal = 0, actualCost = 0;

                selectedProteins.forEach(prot => {
                    let grams = (protPerSource / prot.proteina) * 100;
                    grams = getRealisticGrams(prot, grams);

                    const p = (grams / 100) * prot.proteina;
                    const c = (grams / 100) * prot.carbs;
                    const g = (grams / 100) * prot.gordura;
                    const cal = (grams / 100) * prot.calorias;
                    const cost = (grams / 100) * prot.custo;

                    actualProt += p; actualCarbs += c; actualFat += g; actualCal += cal; actualCost += cost;
                    proteinItems.push({ protein: prot, grams, p, c, g });
                });

                // SugestÃµes de carbs e gorduras
                const suggestions = mealSuggestions[meal.key] || mealSuggestions.almoco;
                const carbName = suggestions.carbs[Math.floor(Math.random() * suggestions.carbs.length)];
                const fatName = suggestions.fats[Math.floor(Math.random() * suggestions.fats.length)];
                const carbFood = carbsDatabase.find(c => c.nome === carbName);
                const fatFood = fatsDatabase.find(f => f.nome === fatName);

                let carbGrams = 0, fatGrams = 0, carbMacros = 0, fatMacros = 0;
                if (carbFood && mealCarbsTarget - actualCarbs > 5) {
                    carbGrams = Math.min(((mealCarbsTarget - actualCarbs) / carbFood.carbs) * 100, 200);
                    carbMacros = (carbGrams / 100) * carbFood.carbs;
                    actualCarbs += carbMacros;
                    actualCal += (carbGrams / 100) * carbFood.calorias;
                }
                if (fatFood && mealFatTarget - actualFat > 2) {
                    fatGrams = Math.min(((mealFatTarget - actualFat) / fatFood.gordura) * 100, 30);
                    fatMacros = (fatGrams / 100) * fatFood.gordura;
                    actualFat += fatMacros;
                    actualCal += (fatGrams / 100) * fatFood.calorias;
                }

                totalProt += actualProt; totalCarbs += actualCarbs; totalFat += actualFat; totalCal += actualCal; totalCost += actualCost;

                // Renderizar HTML da refeiÃ§Ã£o
                planHTML += `<div class="card-pro" style="margin-bottom: var(--space-md); border-left: 3px solid var(--gold);">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-md);">
                        <h4 style="color: var(--gold);">${meal.label}</h4>
                        <span style="color: var(--text-secondary);">${actualCal.toFixed(0)} kcal</span>
                    </div>`;

                proteinItems.forEach(item => {
                    const isFavorite = favorites.includes(item.protein.id);
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--primary);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: var(--primary);">ðŸ¥© ${item.protein.nome} ${isFavorite ? 'â­' : ''}</strong>
                            <span>${formatQuantity(item.protein.nome, item.grams)}</span>
                        </div>
                        <div style="font-size: 12px; color: var(--text-muted);">${item.p.toFixed(1)}g prot | ${item.c.toFixed(1)}g carb | ${item.g.toFixed(1)}g gord</div>
                    </div>`;
                });

                if (carbFood && carbGrams > 0) {
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--accent);">
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--accent);">ðŸš ${carbFood.nome}</span><span>${carbGrams.toFixed(0)}g</span></div>
                        <div style="font-size: 12px; color: var(--text-muted);">${carbMacros.toFixed(1)}g carb</div>
                    </div>`;
                }

                if (fatFood && fatGrams > 0) {
                    planHTML += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm); border-left: 3px solid var(--danger);">
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--danger);">ðŸ¥‘ ${fatFood.nome}</span><span>${fatGrams.toFixed(0)}g</span></div>
                        <div style="font-size: 12px; color: var(--text-muted);">${fatMacros.toFixed(1)}g gord</div>
                    </div>`;
                }

                planHTML += `<div style="font-size: 12px; color: var(--text-secondary); border-top: 1px solid var(--border-default); padding-top: var(--space-sm); margin-top: var(--space-sm);">
                    <strong>Total:</strong> ${actualProt.toFixed(0)}g prot | ${actualCarbs.toFixed(0)}g carb | ${actualFat.toFixed(0)}g gord
                </div></div>`;

                detailedMeals.push({
                    key: meal.key, label: meal.label,
                    proteins: proteinItems.map(i => ({
                        id: i.protein.id,
                        nome: i.protein.nome,
                        quantidade: formatQuantity(i.protein.nome, i.grams),
                        grams: i.grams,
                        macros: { proteina: i.p.toFixed(1), carbs: i.c.toFixed(1), gordura: i.g.toFixed(1) }
                    })),
                    carb: carbFood && carbGrams > 0 ? { nome: carbFood.nome, quantidade: carbGrams.toFixed(0) + 'g', macros: carbMacros.toFixed(1) + 'g carb' } : null,
                    fat: fatFood && fatGrams > 0 ? { nome: fatFood.nome, quantidade: fatGrams.toFixed(0) + 'g', macros: fatMacros.toFixed(1) + 'g gord' } : null,
                    totals: { proteina: actualProt.toFixed(0), carbs: actualCarbs.toFixed(0), gordura: actualFat.toFixed(0), calorias: actualCal.toFixed(0) }
                });
            });

            // Resumo do dia
            planHTML += `<div style="background: var(--gradient-gold); padding: var(--space-lg); border-radius: var(--radius-xl); color: var(--text-inverse); margin-top: var(--space-lg);">
                <h4 style="margin-bottom: var(--space-md); color: var(--text-inverse);">ðŸ“Š Resumo do Dia</h4>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--space-md); text-align: center;">
                    <div><div style="font-size: 28px; font-weight: 800;">${totalProt.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">ProteÃ­nas</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalCarbs.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">Carboidratos</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalFat.toFixed(0)}g</div><div style="font-size: 11px; opacity: 0.9;">Gorduras</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">${totalCal.toFixed(0)}</div><div style="font-size: 11px; opacity: 0.9;">Calorias</div></div>
                    <div><div style="font-size: 28px; font-weight: 800;">R$ ${totalCost.toFixed(2)}</div><div style="font-size: 11px; opacity: 0.9;">Custo</div></div>
                </div>
                <div style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 1px solid rgba(0,0,0,0.1); font-size: 12px; text-align: center;">
                    Meta: ${userMacros.protein}g prot | Atingido: ${((totalProt / userMacros.protein) * 100).toFixed(0)}%
                </div>
            </div>
            <button class="btn-pro btn-secondary-pro btn-full" style="margin-top: var(--space-lg);" onclick="savePlanToHistory()">ðŸ’¾ Salvar no HistÃ³rico</button>
            <button class="btn-pro btn-outline-pro btn-full" style="margin-top: var(--space-sm);" onclick="generateAutoPlan()">ðŸ”„ Gerar Novo Plano</button>`;

            document.getElementById('plan-results').innerHTML = planHTML;
            document.getElementById('plan-results').style.display = 'block';
            document.getElementById('plan-results').scrollIntoView({ behavior: 'smooth' });

            window.currentPlan = {
                date: new Date().toISOString(),
                protein: totalProt.toFixed(0),
                carbs: totalCarbs.toFixed(0),
                fat: totalFat.toFixed(0),
                calories: totalCal.toFixed(0),
                cost: totalCost.toFixed(2),
                meals: detailedMeals
            };

            addXP(30);
            showToast('success', 'âœ¨ Plano gerado!', 'Plano automÃ¡tico criado com sucesso.');
        }

        function savePlanToHistory() {
            if (!window.currentPlan) return;
            history.unshift(window.currentPlan);
            if (history.length > 30) history = history.slice(0, 30);
            localStorage.setItem('history', JSON.stringify(history));
            renderHistory();
            checkAchievements();
            showToast('success', 'Plano salvo!', 'Acesse o HistÃ³rico para ver.');
        }

        // === HISTÃ“RICO ===
        function renderHistory() {
            const container = document.getElementById('history-list');
            if (!history.length) {
                container.innerHTML = '<div class="empty-state-pro"><div class="icon">ðŸ“œ</div><h3>HistÃ³rico vazio</h3><p>Crie um plano no Planejador</p></div>';
                return;
            }
            container.innerHTML = history.map((plan, idx) => {
                const date = new Date(plan.date);
                return `<div class="history-item-pro" onclick="viewHistoryDetails(${idx})">
                    <div class="history-header">
                        <span class="history-date">ðŸ“… ${date.toLocaleDateString('pt-BR')} Ã s ${date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}</span>
                        <button class="btn-pro btn-outline-pro" style="padding: 4px 10px;" onclick="event.stopPropagation(); deleteHistoryItem(${idx})">ðŸ—‘ï¸</button>
                    </div>
                    <div class="history-macros">${plan.protein}g prot | ${plan.carbs}g carb | ${plan.fat}g gord | ${plan.calories} kcal</div>
                </div>`;
            }).join('');
        }

        function viewHistoryDetails(idx) {
            const plan = history[idx];
            if (!plan) return;
            const date = new Date(plan.date);

            let html = `<div class="card-pro">
                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-lg);">
                    <div><h3 style="color: var(--primary);">ðŸ“‹ Detalhes do Plano</h3><p style="color: var(--text-secondary);">${date.toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p></div>
                    <button class="btn-pro btn-outline-pro" onclick="closeHistoryDetails()">âœ•</button>
                </div>
                <div style="background: var(--gradient-primary); padding: var(--space-lg); border-radius: var(--radius-lg); color: white; margin-bottom: var(--space-lg);">
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--space-sm); text-align: center;">
                        <div><div style="font-size: 24px; font-weight: 800;">${plan.protein}g</div><div style="font-size: 10px;">Prot</div></div>
                        <div><div style="font-size: 24px; font-weight: 800;">${plan.carbs}g</div><div style="font-size: 10px;">Carb</div></div>
                        <div><div style="font-size: 24px; font-weight: 800;">${plan.fat}g</div><div style="font-size: 10px;">Gord</div></div>
                        <div><div style="font-size: 24px; font-weight: 800;">${plan.calories}</div><div style="font-size: 10px;">Kcal</div></div>
                        <div><div style="font-size: 24px; font-weight: 800;">R$ ${plan.cost}</div><div style="font-size: 10px;">Custo</div></div>
                    </div>
                </div>`;

            if (plan.meals && Array.isArray(plan.meals)) {
                plan.meals.forEach(meal => {
                    html += `<div style="background: var(--bg-base); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm);">
                        <strong style="color: var(--primary);">${meal.label}</strong>
                        <div style="margin-top: var(--space-sm);">`;
                    meal.proteins.forEach(p => {
                        html += `<div style="font-size: 13px; margin-bottom: 4px;">ðŸ¥© ${p.nome} - ${p.quantidade}</div>`;
                    });
                    if (meal.carb) html += `<div style="font-size: 13px; color: var(--accent);">ðŸš ${meal.carb.nome} - ${meal.carb.quantidade}</div>`;
                    if (meal.fat) html += `<div style="font-size: 13px; color: var(--danger);">ðŸ¥‘ ${meal.fat.nome} - ${meal.fat.quantidade}</div>`;
                    html += `</div></div>`;
                });
            }

            html += `<button class="btn-pro btn-primary-pro btn-full" onclick="shareHistoryToWhatsApp(${idx})" style="margin-top: var(--space-lg);">ðŸ“± Compartilhar no WhatsApp</button></div>`;

            document.getElementById('history-details').innerHTML = html;
            document.getElementById('history-details').style.display = 'block';
            document.getElementById('history-details').scrollIntoView({ behavior: 'smooth' });
        }

        function closeHistoryDetails() {
            document.getElementById('history-details').style.display = 'none';
        }

        function deleteHistoryItem(idx) {
            if (confirm('Remover este plano?')) {
                history.splice(idx, 1);
                localStorage.setItem('history', JSON.stringify(history));
                renderHistory();
                closeHistoryDetails();
            }
        }

        function clearHistory() {
            if (confirm('Limpar todo o histÃ³rico?')) {
                history = [];
                localStorage.setItem('history', JSON.stringify(history));
                renderHistory();
            }
        }

        function shareHistoryToWhatsApp(idx) {
            const plan = history[idx];
            if (!plan) return;
            const date = new Date(plan.date).toLocaleDateString('pt-BR');

            let msg = `*ðŸŽ¯ MEU PLANO ALIMENTAR*\nðŸ“… ${date}\n\n*ðŸ“Š RESUMO*\nðŸ¥© ProteÃ­nas: ${plan.protein}g\nðŸš Carboidratos: ${plan.carbs}g\nðŸ¥‘ Gorduras: ${plan.fat}g\nðŸ”¥ Calorias: ${plan.calories} kcal\nðŸ’° Custo: R$ ${plan.cost}\n\n`;

            if (plan.meals && Array.isArray(plan.meals)) {
                msg += '*ðŸ½ï¸ REFEIÃ‡Ã•ES*\n';
                plan.meals.forEach(meal => {
                    msg += `\n${meal.label}:\n`;
                    meal.proteins.forEach(p => msg += `  ðŸ¥© ${p.nome} - ${p.quantidade}\n`);
                    if (meal.carb) msg += `  ðŸš ${meal.carb.nome} - ${meal.carb.quantidade}\n`;
                    if (meal.fat) msg += `  ðŸ¥‘ ${meal.fat.nome} - ${meal.fat.quantidade}\n`;
                });
            }

            msg += `\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nðŸ’ª ProteÃ­naMax PRO`;
            window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // === LISTA DE COMPRAS ===
        function generateShoppingList() {
            if (!window.currentPlan || !window.currentPlan.meals) {
                showToast('warning', 'Sem plano', 'Gere um plano primeiro no Planejador.');
                return;
            }

            const items = new Map();
            window.currentPlan.meals.forEach(meal => {
                meal.proteins.forEach(p => {
                    const key = p.nome;
                    if (items.has(key)) items.get(key).grams += p.grams;
                    else items.set(key, { name: p.nome, grams: p.grams, checked: false });
                });
                if (meal.carb) {
                    const key = meal.carb.nome;
                    const grams = parseFloat(meal.carb.quantidade);
                    if (items.has(key)) items.get(key).grams += grams;
                    else items.set(key, { name: meal.carb.nome, grams, checked: false });
                }
                if (meal.fat) {
                    const key = meal.fat.nome;
                    const grams = parseFloat(meal.fat.quantidade);
                    if (items.has(key)) items.get(key).grams += grams;
                    else items.set(key, { name: meal.fat.nome, grams, checked: false });
                }
            });

            shoppingList = Array.from(items.values());
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            localStorage.setItem('hasShoppingList', 'true');
            checkAchievements();
            renderShoppingList();
            showToast('success', 'Lista gerada!', `${shoppingList.length} itens adicionados.`);
        }

        function renderShoppingList() {
            const container = document.getElementById('shopping-list');
            if (!shoppingList.length) {
                container.innerHTML = '<div class="empty-state-pro"><div class="icon">ðŸ›’</div><h3>Lista vazia</h3><p>Gere um plano alimentar para criar sua lista.</p></div>';
                return;
            }
            container.innerHTML = shoppingList.map((item, idx) => `
                <div class="shopping-item ${item.checked ? 'checked' : ''}">
                    <div class="shopping-checkbox ${item.checked ? 'checked' : ''}" onclick="toggleShoppingItem(${idx})">${item.checked ? 'âœ“' : ''}</div>
                    <div style="flex: 1;"><strong>${item.name}</strong><div style="font-size: 12px; color: var(--text-muted);">${item.grams.toFixed(0)}g (por dia)</div></div>
                </div>
            `).join('');
        }

        function toggleShoppingItem(idx) {
            shoppingList[idx].checked = !shoppingList[idx].checked;
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            renderShoppingList();
        }
    </script>
</body>
</html>
